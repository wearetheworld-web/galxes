(window.webpackJsonp=window.webpackJsonp||[]).push([[888,104,105,155,665,687,709,748,771,1087],{2819:function(t,e,n){"use strict";n.r(e);var r=n(11),o=n(12),c=n(19),l=n(24),h=n(17),m=n(8),d=(n(30),n(16),n(58),n(14)),f=n(152);function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(h.a)(t);if(e){var o=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var y=function(t,e,n,desc){var r,o=arguments.length,c=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(m.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(c=(o<3?r(c):o>3?r(e,n,c):r(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},x=function(t){Object(c.a)(n,t);var e=v(n);function n(){var t;return Object(r.a)(this,n),(t=e.apply(this,arguments)).isLoading=!1,t}return Object(o.a)(n,[{key:"mounted",value:function(){this.$nuxt.$on("approve-status",this.onApproveStatus)}},{key:"beforeDestroy",value:function(){this.$nuxt.$off("approve-status",this.onApproveStatus)}},{key:"approveClick",value:function(){this.isLoading=!0,this.approveHandler()}},{key:"onApproveStatus",value:function(t){this.isLoading=!1,this.$emit("onApprove",t)}}]),n}(d.Vue);y([Object(d.Prop)({required:!0,default:!1})],x.prototype,"approveHandler",void 0),y([Object(d.Prop)({type:String,required:!1,default:"#5360FF"})],x.prototype,"bgColor",void 0),y([Object(d.Prop)({type:Boolean,required:!0,default:!1})],x.prototype,"claimDisabled",void 0);var k=x=y([Object(d.Component)({components:{GalaxyButton:f.default}})],x),C=n(32),component=Object(C.a)(k,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("GalaxyButton",t._b({attrs:{color:"primary",loading:t.isLoading,disabled:t.claimDisabled},on:{click:t.approveClick}},"GalaxyButton",t.$attrs,!1),[t._v("\n  Approve\n")])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{GalaxyButton:n(152).default})},2828:function(t,e,n){var content=n(3112);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(41).default)("12e12c18",content,!0,{sourceMap:!1})},2840:function(t,e,n){"use strict";n.r(e),n.d(e,"Operation",(function(){return Z}));n(46),n(58);var r=n(35),o=n(1),c=n(11),l=n(12),h=n(19),m=n(24),d=n(17),f=n(8),v=(n(66),n(30),n(16),n(117),n(80),n(71),n(91),n(37),n(48),n(86),n(114),n(337),n(14)),y=n(152),x=n(2819),k=n(2734),C=n(134),w=n(9),O=n(2820),R=n(230),T=n(55),_=n(38),D=n(2578),$=n.n(D),P=n(2582),filter=n(2618),I=n(2982),j=n(210),A=n(3104),S=n(2439),B=n(2983),F=n(195),E=n.n(F),G=n(2767),L=n(2504),N=n.n(L),M=n(3109),W=n.n(M),U=n(2885),H=n.n(U),z=n(3110),J=n.n(z),V=n(2699),Y=n(701),Q=n(178),K=n(72);function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(d.a)(t);if(e){var o=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(m.a)(this,n)}}var Z,tt=function(t,e,n,desc){var r,o=arguments.length,c=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(f.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(c=(o<3?r(c):o>3?r(e,n,c):r(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c};!function(t){t[t.Default=0]="Default",t[t.Claim=1]="Claim",t[t.StakeIn=2]="StakeIn",t[t.StakeOut=3]="StakeOut",t[t.Forge=4]="Forge"}(Z||(Z={}));var et=function(t){Object(h.a)(it,t);var e,n,m,d,f,v,y,x,k,O,R,D,$,F,L,M,U,z,Y,tt,et,at=X(it);function it(){var t;return Object(c.a)(this,it),(t=at.apply(this,arguments)).inputBatchNum=1,t.countdownToStartTime=0,t.countdownToClaimEndTime=0,t.erc20Fee=-1,t.erc20FeeTokenAddr="",t.erc20FeeToken="",t.allowance=0,t.platformFee=0,t.forgeApprove=!0,t.airDropIsClaimed=!1,t.claimLoading=!1,t.isMinter=!0,t.isShowOutOfBalanceDialog=!1,t.isClaimGaslessWithOwnFee=!1,t.gaslessOutOfBalance=!1,t}return Object(l.a)(it,[{key:"isFeeTips",get:function(){return this.erc20Fee||this.platformFee}},{key:"isOat",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.Oat}},{key:"isNFT",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.Drop}},{key:"isBounty",get:function(){return this.campaign.type===w.n.Bounty}},{key:"isDiscordRole",get:function(){return this.campaign.type===w.n.DiscordRole}},{key:"isTokenReward",get:function(){return this.campaign.type===w.n.Token}},{key:"showClaimNumberInfo",get:function(){return!this.isBounty&&!this.isTokenReward}},{key:"isRaffle",get:function(){return this.campaign.distributionType===w.m.Raffle}},{key:"currentCampaignChain",get:function(){var t=this;if((this.isBounty||this.isTokenReward)&&this.campaign.chain)return Object(T.D)(this.$vuetify.breakpoint.mobile).find((function(e){return e.name===t.campaign.chain}));if(this.campaign&&this.campaign.gamification.nfts.length>0){var e=this.campaign.gamification.nfts[0].nft.nftCore.chain;return Object(T.D)(this.$vuetify.breakpoint.mobile).find((function(t){return t.name===e}))}}},{key:"isSolanaClaiming",get:function(){return!!this.currentCampaignChain&&!(!this.claimLoading||this.$store.getters.connectMethod!==_.a.Solana)}},{key:"account",get:function(){return this.$store.getters.getAccount}},{key:"user",get:function(){return this.$store.getters.getUser}},{key:"connectMethod",get:function(){return this.$store.getters.connectMethod}},{key:"spaceName",get:function(){return this.campaign.dao.name}},{key:"wonTheTokenRaffle",get:function(){return!!(this.isTokenReward&&this.isRaffle&&this.isTokenRaffleParticipateEnded)&&(1===Number(this.maxCount)&&0===Number(this.usedCount))}},{key:"claimedTheTokenRaffle",get:function(){return!!(this.isTokenReward&&this.isRaffle&&this.isTokenRaffleParticipateEnded)&&(1===Number(this.maxCount)&&1===Number(this.usedCount))}},{key:"loseTheTokenRaffle",get:function(){return!!(this.isTokenReward&&this.isRaffle&&this.isTokenRaffleParticipateEnded)&&(0===Number(this.maxCount)&&1===Number(this.usedCount))}},{key:"tokenAddress",get:function(){return this.campaign&&this.erc20Fee>0?this.erc20FeeTokenAddr:""}},{key:"spaceStationAddress",get:function(){return this.campaign&&this.campaign.spaceStation?this.campaign.spaceStation.address:""}},{key:"isParent",get:function(){return!!(this.campaign&&this.campaign.childrenCampaigns&&this.campaign.childrenCampaigns.length>0)}},{key:"startTime",get:function(){return this.campaign&&this.campaign.startTime?this.campaign.startTime:0}},{key:"endTime",get:function(){return this.campaign&&this.campaign.endTime?this.campaign.endTime:0}},{key:"isNotStarted",get:function(){var t=(new Date).getTime()/1e3;return!(!this.campaign||!this.startTime)&&t<this.startTime}},{key:"isEnded",get:function(){var t=(new Date).getTime()/1e3;return!(!this.campaign||!this.endTime)&&(this.isTokenReward&&this.isRaffle?t>=this.claimEndTime:t>=this.endTime)}},{key:"inRaffle",get:function(){return(new Date).getTime()/1e3-this.endTime<60}},{key:"claimEndTime",get:function(){return this.campaign&&this.campaign.claimEndTime?this.campaign.claimEndTime:0}},{key:"isTokenRaffleParticipateEnded",get:function(){var t=(new Date).getTime()/1e3;return!(!this.campaign||!this.endTime)&&t>=this.endTime}},{key:"isParticipated",get:function(){var t;return this.isTokenReward&&this.isRaffle?this.usedCount>0:!!this.campaign.userParticipants&&!!(null===(t=this.campaign.userParticipants)||void 0===t?void 0:t.list.length)}},{key:"currentChain",get:function(){return this.$store.getters.currentChain}},{key:"currentChainName",get:function(){return this.currentChain?this.currentChain.name:""}},{key:"coveredByText",get:function(){return V.e.includes(this.campaign.chain)?this.campaign.space.name:"Galxe"}},{key:"checkIfGaslessOutOfBalance",value:(et=Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isGaslessOutOfBalance();case 2:this.gaslessOutOfBalance=t.sent;case 3:case"end":return t.stop()}}),t,this)}))),function(){return et.apply(this,arguments)})},{key:"isGaslessOutOfBalance",value:(tt=Object(o.a)(regeneratorRuntime.mark((function t(){var e,n,r,data,o,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isGasless){t.next=2;break}return t.abrupt("return",!1);case 2:if(V.e.includes(this.campaign.chain)){t.next=4;break}return t.abrupt("return",!1);case 4:return t.next=6,this.$apollo.query({fetchPolicy:"no-cache",query:J.a,variables:{id:(null===(e=this.campaign.space)||void 0===e?void 0:e.id)||(null===(n=this.campaign.dao)||void 0===n?void 0:n.id),chains:[this.campaign.chain]}});case 6:return r=t.sent,(data=r.data).sapce||data.space.spaceBalance||data.space.spaceBalance.sufficientForGaslessClaimOnChain||this.$errorPlain("Server error, can not get space balance, please try again later."),o=data.space.spaceBalance.sufficientForGaslessClaimOnChain.find((function(t){return t.chain===c.campaign.chain})),t.abrupt("return",o&&!o.sufficient);case 11:case"end":return t.stop()}}),t,this)}))),function(){return tt.apply(this,arguments)})},{key:"claimGaslessWithOwnFee",value:(Y=Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isShowOutOfBalanceDialog=!1,this.isClaimGaslessWithOwnFee=!0,t.next=4,this.claimDrop();case 4:case"end":return t.stop()}}),t,this)}))),function(){return Y.apply(this,arguments)})},{key:"isGasless",get:function(){return this.campaign&&"GASLESS"===this.campaign.gasType.toUpperCase()}},{key:"isOptIn",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.OptIn}},{key:"isOptInEmail",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.OptInEmail}},{key:"isDrop",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.Drop}},{key:"isMysteryBox",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.MysteryBox}},{key:"isMysteryBoxWr",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.MysteryBoxWr}},{key:"isLoyaltyPointMysteryBox",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.PointsMysteryBox}},{key:"isForge",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.Forge}},{key:"isAirDrop",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.Airdrop}},{key:"isDraft",get:function(){return this.campaign&&this.campaign.status===w.b.Draft}},{key:"rewradType",get:function(){return this.campaign.rewardType}},{key:"isFcfs",get:function(){return this.campaign.distributionType===w.m.Fcfs}},{key:"isLoyaltyPoint",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.Points}},{key:"envWrong",get:function(){return!this.isParent&&(!this.isBounty&&(!this.isLoyaltyPointMysteryBox&&!this.isLoyaltyPoint&&(this.isTokenReward?this.isRaffle?this.isTokenRaffleParticipateEnded&&this.wonTheTokenRaffle&&!this.isParticipated&&this.campaign.chain!==this.currentChainName:this.campaign.chain!==this.currentChainName:!(this.isGasless&&this.currentChain&&this.isIntheSamePublicChain(this.campaign.chain,this.currentChainName))&&(!this.isOptIn&&!this.isOptInEmail&&this.account&&(!this.currentChain||this.campaign&&this.campaign.chain!==this.currentChainName)))))}},{key:"isGoing",get:function(){var t=(new Date).getTime()/1e3;return!!this.campaign&&(this.isTokenReward&&this.isRaffle?t>=this.startTime&&t<=this.claimEndTime:0===this.endTime?t>=this.startTime:t>=this.startTime&&t<=this.endTime)}},{key:"nftContractList",get:function(){var t=this;if(this.campaign&&void 0!==this.currentCampaignChain){var e=[];return this.campaign.childrenCampaigns&&this.campaign.childrenCampaigns.length>0?this.campaign.childrenCampaigns.forEach((function(n){n.gamification.nfts.forEach((function(n){if(!e.some((function(t){return t.contractAddress===n.nft.nftCore.contractAddress}))&&void 0!==t.currentCampaignChain&&t.currentCampaignChain.blockExplorerUrls){var address=Object(j.a)(n.nft.nftCore.contractAddress);e.push({addressFormat:address,url:t.fullExpoloreUrl(t.currentCampaignChain.blockExplorerUrls[0],n.nft.nftCore.contractAddress),contractAddress:n.nft.nftCore.contractAddress})}}))})):this.campaign.gamification.nfts.forEach((function(n){if(!e.some((function(t){return t.contractAddress===n.nft.nftCore.contractAddress}))&&void 0!==t.currentCampaignChain&&t.currentCampaignChain.blockExplorerUrls){var address=Object(j.a)(n.nft.nftCore.contractAddress);e.push({addressFormat:address,url:t.fullExpoloreUrl(t.currentCampaignChain.blockExplorerUrls[0],n.nft.nftCore.contractAddress),contractAddress:n.nft.nftCore.contractAddress})}})),e}return[]}},{key:"scanPath",get:function(){return this.isSolanaCampaign?"account":"address"}},{key:"isSolanaCampaign",get:function(){return this.campaign.chain===w.c.SolanaDevnet||this.campaign.chain===w.c.Solana}},{key:"isOptimismCampaign",get:function(){return this.campaign.chain===w.c.Optimism}},{key:"isApotsCampaign",get:function(){return this.campaign.chain===w.c.Aptos||this.campaign.chain===w.c.AptosTestnet}},{key:"isSeiCampaign",get:function(){return this.campaign.chain===w.c.Sei||this.campaign.chain===w.c.Atlantic2}},{key:"isExternalLink",get:function(){return this.campaign&&this.campaign.gamification.type===w.n.ExternalLink}},{key:"showBuyApprove",get:function(){return!(this.allowance>=Number(this.erc20Fee))}},{key:"canBatch",get:function(){return this.account&&this.campaign&&!this.claimDisabled&&0!==this.canClaimNum&&1!==this.canClaimNum&&!this.isGasless&&(this.campaign.gamification.type===w.n.Drop||this.campaign.gamification.type===w.n.MysteryBox||this.campaign.gamification.type===w.n.MysteryBoxWr)}},{key:"claimDisabled",get:function(){return!!this.account&&(this.envWrong||this.notInRegion||!this.campaignIpIsOk||this.airDropIsClaimed||this.isAirDrop&&!this.haveAirDrop||this.isDraft||this.isLoyaltyPoint&&this.remainingAvailablePoints<=0&&this.availableRecurring<=0||!this.isLoyaltyPoint&&this.canClaimNum<=0||this.isRecurring&&!this.satisfyCondition)||!this.isGoing}},{key:"canForge",get:function(){return this.account&&this.isGoing&&!this.envWrong&&!this.notInRegion&&this.campaignIpIsOk&&!this.isDraft}},{key:"notInRegion",get:function(){if(!this.campaign.whitelistRegions||this.campaign.whitelistRegions.length<=0)return!1;var t=this.$store.getters.ipStats;if(!t)return!1;var e=JSON.parse(this.campaign.whitelistRegions).find((function(e){return e.country_code.toLowerCase()===t.country_code.toLowerCase()}));return!e||(!(!e.region_code||e.region_code===t.region_code)||!(!e.city||e.city.toLowerCase()===t.city.toLowerCase()))}},{key:"campaignIpIsOk",get:function(){if(!this.campaign.blacklistCountryCodes)return!0;var t=this.$store.getters.ipStats,e=this.campaign&&this.campaign.blacklistCountryCodes?this.campaign.blacklistCountryCodes.split(","):[];return!t||!e.includes(t.country_code)}},{key:"haveAirDrop",get:function(){return this.campaign&&this.campaign.gamification.airdrop&&this.campaign.gamification.airdrop.addressInfo}},{key:"campaignID",get:function(){return this.campaign?this.campaign.id:""}},{key:"campaignNumID",get:function(){return this.campaign?this.campaign.numberID:0}},{key:"campaignChain",get:function(){return this.campaign&&this.campaign.chain?"MATIC"===this.campaign.chain?"POLYGON":this.campaign.chain:""}},{key:"claimText",get:function(){return this.isDraft?"Draft Campaign":this.isNotStarted?"Not Started":this.isEnded?"Campaign Ended":this.$attrs["is-reached-minting-cap"]?this.isTokenReward&&this.isFcfs?"Reach Amount":"Reached Minting Cap":this.notInRegion?"Not available in Your Region":this.account?this.envWrong?"Switch to ".concat(this.campaignChain):this.isForge?"Start Forging":!this.isLoyaltyPoint&&this.maxCount<=0||this.isLoyaltyPoint&&this.availablePoints<=0||this.isRecurring&&!this.satisfyCondition?"You are Not Eligible":this.isExternalLink?"View Instruction":this.isBounty?"Participate":this.isTokenReward&&this.isRaffle?this.isTokenRaffleParticipateEnded?"Claim":"Participate":this.isAirDrop?this.airDropIsClaimed?"Claimed":"Claim":this.isOptIn||this.isOptInEmail?this.maxCount>0&&0===this.canClaimNum?"Opted In":"Opt In":(this.isMysteryBox||this.isMysteryBoxWr||this.isLoyaltyPointMysteryBox,this.erc20Fee>0||this.platformFee>0?"Buy":"Claim"):"Connect Wallet"}},{key:"tokenExploreUrl",get:function(){return this.currentChain?"".concat(this.currentChain.blockExplorerUrls[0],"/token/").concat(this.erc20FeeTokenAddr):""}},{key:"platformFeeToken",get:function(){return this.currentChain?this.currentChain.nativeCurrency.symbol:""}},{key:"availablePoints",get:function(){var t=0;return(this.campaign.credentialGroups||[]).forEach((function(e){(e.rewards||[]).forEach((function(e){e.rewardType===w.j.Loyaltypoints&&(t+=e.rewardCount)}))})),t}},{key:"remainingAvailablePoints",get:function(){return this.availablePoints-E.a.sum(this.campaign.credentialGroups.map((function(t){return t.claimedLoyaltyPoints})))}},{key:"availableRecurring",get:function(){if(this.isRecurring){var t=this.campaign.whitelistInfo,e=t.currentPeriodClaimedLoyaltyPoints,n=t.currentPeriodMaxLoyaltyPoints;return Math.max(n-e,0)}return 0}},{key:"isRecurring",get:function(){return this.campaign&&this.campaign.recurringType!==w.G.Once}},{key:"satisfyCondition",get:function(){var t,e,n;return!(null===(t=this.campaign.taskConfig)||void 0===t?void 0:t.participateCondition)||(null===(n=null===(e=this.campaign.taskConfig)||void 0===e?void 0:e.participateCondition)||void 0===n?void 0:n.eligible)}},{key:"isWon",get:function(){return E.a.get(this.campaign,"userParticipants.list[0].status")===w.A.Success}},{key:"created",value:function(){this.campaign.startTime&&this.campaign.endTime&&Date.now()>=1e3*this.campaign.startTime&&Date.now()<=1e3*this.campaign.endTime?this.countdownToStartTime=1e3*this.campaign.endTime-Date.now():this.countdownToStartTime=0,this.calCountdownToClaimEndTime()}},{key:"mounted",value:(z=Object(o.a)(regeneratorRuntime.mark((function t(){var e,n,r,o,c,l,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Object(T.E)(this.campaign.chain)||!(this.isDrop||this.isMysteryBox||this.isMysteryBoxWr)||this.isGasless||this.isLoyaltyPoint||this.isLoyaltyPointMysteryBox||this.envWrong||!this.account||this.getFeeInfo(Z.Claim),!this.isAirDrop||!(null===(e=this.campaign.gamification)||void 0===e?void 0:e.airdrop)){t.next=9;break}if(!(null===(r=null===(n=this.campaign.gamification)||void 0===n?void 0:n.airdrop)||void 0===r?void 0:r.addressInfo)){t.next=8;break}return t.next=5,Object(A.b)(null===(c=null===(o=this.campaign.gamification)||void 0===o?void 0:o.airdrop)||void 0===c?void 0:c.addressInfo.index,null===(h=null===(l=this.campaign.gamification)||void 0===l?void 0:l.airdrop)||void 0===h?void 0:h.contractAddress);case 5:this.airDropIsClaimed=t.sent,t.next=9;break;case 8:this.airDropIsClaimed=!0;case 9:if(this.isForge&&(this.getForgeApprove(),this.erc20Fee>0&&this.getAllowance()),!this.isGasless){t.next=13;break}return t.next=13,this.checkIfGaslessOutOfBalance();case 13:case"end":return t.stop()}}),t,this)}))),function(){return z.apply(this,arguments)})},{key:"calCountdownToClaimEndTime",value:function(){this.campaign.claimEndTime&&Date.now()<=1e3*this.campaign.claimEndTime?this.countdownToClaimEndTime=1e3*this.campaign.claimEndTime-Date.now():this.countdownToClaimEndTime=0}},{key:"onInputBatchNumChange",value:function(t){this.inputBatchNum=t}},{key:"addChain",value:(U=Object(o.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.currentCampaignChain){t.next=2;break}return t.abrupt("return");case 2:if(this.$store.getters.connectMethod!==_.a.WalletConnect||!Object(T.E)(this.currentCampaignChain.name)){t.next=5;break}return this.$store.commit("setSnackbar",{state:C.SnackbarStatus.INFO,body:{msg:"Please switch chain on your wallet app, and reconnect it.",isCenter:!0},type:C.snackbarType.Default}),t.abrupt("return");case 5:return t.next=7,Object(_.o)(this,this.currentCampaignChain);case 7:if(!(window&&window.web3Global&&window.web3Global.eth)){t.next=14;break}return t.next=10,window.web3Global.eth.getChainId();case 10:e=t.sent,this.$store.commit("setChainID",e),t.next=15;break;case 14:this.$store.commit("setCurrentChain",this.currentCampaignChain);case 15:case"end":return t.stop()}}),t,this)}))),function(){return U.apply(this,arguments)})},{key:"handleEnd",value:(M=Object(o.a)(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.countdownToStartTime=0,this.calCountdownToClaimEndTime(),t.next=4,this.$emit("getParticipants");case 4:this.$emit("refreshCampaign"),e=setInterval(Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.$emit("getParticipants");case 2:n.$emit("refreshCampaign"),n.$attrs["raffle-in-progress"]||clearInterval(e);case 4:case"end":return t.stop()}}),t)}))),1e4);case 6:case"end":return t.stop()}}),t,this)}))),function(){return M.apply(this,arguments)})},{key:"forgeHandler",value:function(){if(!this.account)return this.$nuxt.$emit("clickConnectWallet",null);this.$nuxt.$emit("showForgePage",!0)}},{key:"onApprove",value:function(t){"completed"===t&&this.getAllowance()}},{key:"getAllowance",value:(L=Object(o.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(P.b)(this.account,this.tokenAddress,this.spaceStationAddress,this.$store);case 2:(e=t.sent)&&(this.allowance=e);case 4:case"end":return t.stop()}}),t,this)}))),function(){return L.apply(this,arguments)})},{key:"approveAdopt",value:(F=Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(P.l)(this.account,this.tokenAddress,1e7,this.spaceStationAddress,this.$store);case 2:case"end":return t.stop()}}),t,this)}))),function(){return F.apply(this,arguments)})},{key:"getFeeInfo",value:($=Object(o.a)(regeneratorRuntime.mark((function t(e){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(P.c)(this.campaignNumID,e,this.spaceStationAddress,this.$store);case 2:if(n=t.sent){t.next=7;break}throw r='Contract information is temporarily unavailable due to your wallet rpc fluctuation. Please try again later or follow the FAQ: <a class="galaxy-link" href="https://help.galxe.com/en/articles/7109304-contract-fee-info-unavailable" target=\'_blank\' rel="noopener noreferrer">https://help.galxe.com/en/articles/7109304-contract-fee-info-unavailable</a> to reset your network.',this.$store.commit("setSnackbar",{state:C.SnackbarStatus.ERROR,body:{msg:r},type:C.snackbarType.Default}),new Error(r);case 7:return this.platformFee=Object(filter.c)(n.platformFee*Math.pow(10,-18),5),t.next=10,Object(P.m)(n.erc20);case 10:return o=t.sent,this.erc20Fee=Object(filter.c)(n.erc20Fee*Math.pow(10,-1*o),5),this.erc20FeeTokenAddr=n.erc20,t.abrupt("return",n);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return $.apply(this,arguments)})},{key:"onApproveForge",value:function(t){"completed"===t&&(this.getForgeApprove(),this.erc20Fee>0&&this.getAllowance())}},{key:"getForgeApprove",value:(D=Object(o.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.envWrong||!this.isGoing){t.next=5;break}return t.next=3,Object(I.a)(this.account,this.spaceStationAddress,this.nftContractList[0].contractAddress);case 3:e=t.sent,this.forgeApprove=e;case 5:case"end":return t.stop()}}),t,this)}))),function(){return D.apply(this,arguments)})},{key:"isIntheSamePublicChain",value:function(t,e){return!(!Object(T.E)(t)||!Object(T.E)(e))||!(!Object(T.F)(t)||!Object(T.F)(e))}},{key:"fullExpoloreUrl",value:function(t,address){var e="".concat(t,"/").concat(this.scanPath,"/").concat(address);return this.isSolanaCampaign&&this.campaign.chain===w.c.SolanaDevnet&&(e+="?cluster=devnet"),this.isApotsCampaign&&(e="".concat(t,"/nft-collection/").concat(address,"/Galxe%20OAT")),e}},{key:"approveForge",value:(R=Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.showBuyApprove){t.next=3;break}return t.next=3,this.approveAdopt();case 3:return t.next=5,Object(I.c)(this.spaceStationAddress,this.account,this.nftContractList[0].contractAddress);case 5:case"end":return t.stop()}}),t,this)}))),function(){return R.apply(this,arguments)})},{key:"isWithinOptimismDate",value:function(){var t=(new Date).getTime(),e=Date.UTC(2023,5,6,16,0,0),n=Date.UTC(2023,5,6,20,0,0);return t>=e&&t<=n}},{key:"claimHandler",value:(O=Object(o.a)(regeneratorRuntime.mark((function t(param){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.account){t.next=2;break}return t.abrupt("return",this.$nuxt.$emit("clickConnectWallet",null));case 2:if(!this.isOptimismCampaign||!this.isWithinOptimismDate()){t.next=5;break}return this.$store.commit("setSnackbar",{state:C.SnackbarStatus.ERROR,body:{msg:"Error Message: Optimism Mainnet maintenance in progress. Please try again in 2-4 hours.",isCenter:!0},type:C.snackbarType.Default}),t.abrupt("return");case 5:if(!this.isSolanaCampaign){t.next=10;break}return t.next=8,this.handleSolanaClaim(param);case 8:case 13:case 18:case 23:case 28:t.next=36;break;case 10:if(!this.canBatch){t.next=15;break}return t.next=13,this.batchClaim(param);case 15:if(!this.isExternalLink){t.next=20;break}return t.next=18,this.claimExternal();case 20:if(!this.isAirDrop){t.next=25;break}return t.next=23,this.claimAirDrop();case 25:if(!this.isOptIn){t.next=30;break}return t.next=28,this.claimOptIn();case 30:if(!this.isOptInEmail){t.next=34;break}this.$nuxt.$emit("showEmailDialog",!0),t.next=36;break;case 34:return t.next=36,this.claimDrop();case 36:case"end":return t.stop()}}),t,this)}))),function(t){return O.apply(this,arguments)})},{key:"handleSolanaClaim",value:(k=Object(o.a)(regeneratorRuntime.mark((function t(e){var n,r,o,c,l,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=1,!this.canBatch){t.next=6;break}if(!((r=Math.floor(Number(e)))<=0||-1!==this.canClaimNum&&r>this.canClaimNum)){t.next=6;break}return t.abrupt("return",this.$store.commit("setSnackbar",{state:C.SnackbarStatus.ERROR,body:{msg:"Please enter a number from 1 to ".concat(this.canClaimNum)},type:C.snackbarType.Default}));case 6:return this.claimLoading=!0,t.next=9,Object(S.a)();case 9:if(o=t.sent){t.next=13;break}return this.claimLoading=!1,t.abrupt("return");case 13:return c={input:{signature:"",campaignID:null===(n=this.campaign)||void 0===n?void 0:n.id,address:this.account,mintCount:r,chain:this.campaign.chain,captcha:{lotNumber:o.lot_number,captchaOutput:o.captcha_output,passToken:o.pass_token,genTime:o.gen_time}}},t.next=16,this.$apollo.mutate({mutation:N.a,variables:c});case 16:if(l=t.sent,!(data=l.data)||data.prepareParticipate.allow){t.next=22;break}return this.$errorPlain(data.prepareParticipate.disallowReason),this.claimLoading=!1,t.abrupt("return");case 22:return t.next=24,this.claimSolanaCampaign(data.prepareParticipate);case 24:t.next=30;break;case 26:t.prev=26,t.t0=t.catch(0),this.claimLoading=!1,this.$gtag.event("gtm_campaign_claim_fail",{message:t.t0.message,errorcode:t.t0.code||500});case 30:case"end":return t.stop()}}),t,this,[[0,26]])}))),function(t){return k.apply(this,arguments)})},{key:"claimSolanaCampaign",value:(x=Object(o.a)(regeneratorRuntime.mark((function t(e){var n,r,o,c,data,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.solanaTxResp.signedTx,r=e.solanaTxResp.verifyID,t.next=4,Object(B.b)({message:n,wallet:this.$store.getters.connectMethod});case 4:return o=t.sent,t.next=7,this.$apollo.mutate({mutation:W.a,variables:{input:{campaignID:this.campaignID,address:this.account,chain:this.campaign.chain,signedTx:o,verifyID:r}}});case 7:if(c=t.sent,data=c.data,this.claimLoading=!1,(l=data.participateSolana).success){t.next=14;break}return this.$errorPlain(l.failReason),t.abrupt("return");case 14:return t.next=16,this.claimGaslessCampaign(e);case 16:case"end":return t.stop()}}),t,this)}))),function(t){return x.apply(this,arguments)})},{key:"claimGaslessCampaign",value:function(t){var e=this;try{if(this.claimLoading=!0,t&&t.allow&&t.mintFuncInfo&&this.isMinter){var n=t.mintFuncInfo.verifyIDs[0];if(!n)throw new Error("System server error.");setTimeout((function(){var t=e.campaign&&e.campaign.gamification.nfts.length>0&&e.campaign.gamification.nfts[0].nft.nftCore.chain;e.$nuxt.$emit("async-claiming",{verifyId:n,campaignName:e.campaign.name,campaignId:e.campaign.id,chain:t,campaignUrl:window.location.href,campaign:e.campaign}),e.$listeners.changeUsedCount(e.usedCount+1),e.claimLoading=!1}),2e3)}t.allow||(this.$errorPlain(t.disallowReason||"server error"),this.claimLoading=!1)}catch(t){this.claimLoading=!1,this.$gtag.event("gtm_campaign_claim_fail",{message:t.message,errorcode:t.code||500})}}},{key:"batchClaim",value:(y=Object(o.a)(regeneratorRuntime.mark((function t(e){var n,r,o,c,l,h,data,m,d,f,v,y,x,k;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!((r=Number(e))>30)){t.next=4;break}return t.abrupt("return",this.$store.commit("setSnackbar",{state:C.SnackbarStatus.ERROR,body:{msg:"Maximum 30 claims per time"},type:C.snackbarType.Default}));case 4:if(!(r<=0||-1!==this.canClaimNum&&r>this.canClaimNum||Math.floor(r)!==r)){t.next=6;break}return t.abrupt("return",this.$store.commit("setSnackbar",{state:C.SnackbarStatus.ERROR,body:{msg:"Please enter a number from 1 to ".concat(this.canClaimNum)},type:C.snackbarType.Default}));case 6:if(1!==r){t.next=8;break}return t.abrupt("return",this.claimDrop());case 8:return this.claimLoading=!0,t.next=11,this.getFeeInfo(Z.Claim);case 11:return o=t.sent,t.next=14,Object(S.a)();case 14:if(c=t.sent){t.next=18;break}return this.claimLoading=!1,t.abrupt("return");case 18:return l={input:{signature:"",campaignID:null===(n=this.campaign)||void 0===n?void 0:n.id,address:this.account,mintCount:r,chain:this.campaign.chain,captcha:{lotNumber:c.lot_number,captchaOutput:c.captcha_output,passToken:c.pass_token,genTime:c.gen_time}}},t.next=21,this.$apollo.mutate({mutation:N.a,variables:l});case 21:h=t.sent,(data=h.data)&&data.prepareParticipate.allow&&this.isMinter&&(m=data.prepareParticipate.signature,d=data.prepareParticipate.mintFuncInfo.verifyIDs,f=data.prepareParticipate.mintFuncInfo.powahs,v=data.prepareParticipate.mintFuncInfo.nftCoreAddress,y=this.spaceStationAddress,x=data.prepareParticipate.mintFuncInfo.cap,k=data.prepareParticipate.nonce,x>0?Object(P.f)(r,this,this.currentChain,o.platformFee*r,this.campaignID,this.campaignNumID,v,d,f,this.account,"",m,y,x,this.$store,k):Object(P.e)(r,this,this.currentChain,o.platformFee*r,this.campaignID,this.campaignNumID,v,d,f,this.account,"",m,y,this.$store,k)),data&&!data.prepareParticipate.allow&&this.$errorPlain(data.prepareParticipate.disallowReason),this.claimLoading=!1,t.next=32;break;case 28:t.prev=28,t.t0=t.catch(0),this.claimLoading=!1,this.$gtag.event("gtm_campaign_claim_fail",{message:t.t0.message,errorcode:t.t0.code||500});case 32:case"end":return t.stop()}}),t,this,[[0,28]])}))),function(t){return y.apply(this,arguments)})},{key:"claimDrop",value:(v=Object(o.a)(regeneratorRuntime.mark((function t(){var e,n,r,o,c,l,h,m,d,f,v,y,x,k,C,O,data,R,T,D,$,I,j,A,B,F,E,L,M,W,U;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.isBounty){t.next=16;break}if(this.rewradType!==w.H.Email||this.user.hasEmail){t.next=5;break}return this.$nuxt.$emit("setParticipantDialog",{participantDialog:!0,participantsIDType:"email",participantsUrl:"/accountSetting?tab=Account"}),t.abrupt("return");case 5:if(this.rewradType!==w.H.Evm||this.user.address){t.next=8;break}return this.$nuxt.$emit("setParticipantDialog",{participantDialog:!0,participantsIDType:"evm address",participantsUrl:"/accountSetting?tab=WalletAddress"}),t.abrupt("return");case 8:if(this.rewradType!==w.H.Solana||this.user.solanaAddress){t.next=11;break}return this.$nuxt.$emit("setParticipantDialog",{participantDialog:!0,participantsIDType:"solana address",participantsUrl:"/accountSetting?tab=WalletAddress"}),t.abrupt("return");case 11:if(this.rewradType!==w.H.Aptos||this.user.aptosAddress){t.next=14;break}return this.$nuxt.$emit("setParticipantDialog",{participantDialog:!0,participantsIDType:"aptos address",participantsUrl:"/accountSetting?tab=WalletAddress"}),t.abrupt("return");case 14:t.next=30;break;case 16:if(!this.isDiscordRole){t.next=30;break}if(this.user.hasDiscord){t.next=20;break}return this.$nuxt.$emit("setDiscordDialog",{discordDialog:!0,discordContent:"Please connect to your Discord first before claiming the role reward.",discordButton:"Connect Discord",discordButtonHandle:this.handleConnectDiscord}),t.abrupt("return");case 20:return t.next=22,this.isGuildMember();case 22:if(!(x=t.sent)){t.next=30;break}if(!x.failReason){t.next=27;break}return this.$nuxt.$emit("setDiscordDialog",{discordDialog:!0,discordContent:x.failReason}),t.abrupt("return");case 27:if(!1!==x.isGuildMember){t.next=30;break}return this.$nuxt.$emit("setDiscordDialog",{discordDialog:!0,discordContent:"Please join the Discord before claiming the role reward.",discordButton:"Join",discordButtonHandle:this.handleJoinDiscord}),t.abrupt("return");case 30:if(this.claimLoading=!0,!this.isGasless){t.next=34;break}return t.next=34,this.checkIfGaslessOutOfBalance();case 34:if(!this.isGasless||!this.gaslessOutOfBalance||this.isClaimGaslessWithOwnFee){t.next=38;break}return this.isShowOutOfBalanceDialog=!0,this.claimLoading=!1,t.abrupt("return");case 38:if(!this.isGasless||!this.gaslessOutOfBalance||this.campaign.chain===this.currentChain){t.next=42;break}return this.$nuxt.$on("rec-result",this.onGaslessToGasTrxResult),t.next=42,Object(_.o)(this,this.currentCampaignChain);case 42:return t.next=44,Object(S.a)();case 44:if(k=t.sent){t.next=48;break}return this.claimLoading=!1,t.abrupt("return");case 48:return C={input:{signature:"",campaignID:null===(e=this.campaign)||void 0===e?void 0:e.id,address:this.account,mintCount:1,chain:this.campaign.chain,captcha:{lotNumber:k.lot_number,captchaOutput:k.captcha_output,passToken:k.pass_token,genTime:k.gen_time}}},t.next=51,this.$apollo.mutate({mutation:N.a,variables:C});case 51:if(O=t.sent,!((data=O.data)&&data.prepareParticipate.allow&&this.isMinter)){t.next=122;break}if(R=data.prepareParticipate.signature,T=null===(n=data.prepareParticipate.mintFuncInfo)||void 0===n?void 0:n.verifyIDs[0],D=null===(r=data.prepareParticipate.mintFuncInfo)||void 0===r?void 0:r.powahs[0],$=null===(o=data.prepareParticipate.mintFuncInfo)||void 0===o?void 0:o.nftCoreAddress,I=this.spaceStationAddress,j=null===(c=data.prepareParticipate.mintFuncInfo)||void 0===c?void 0:c.cap,A=data.prepareParticipate.nonce,B=null===(l=data.prepareParticipate.aptosTxResp)||void 0===l?void 0:l.signatureExpiredAt,F=null===(h=data.prepareParticipate.aptosTxResp)||void 0===h?void 0:h.tokenName,E=null===(m=data.prepareParticipate.metaTxResp)||void 0===m?void 0:m.metaTxHash,L=null===(d=data.prepareParticipate.tokenRewardCampaignTxResp)||void 0===d?void 0:d.verifyID,M=null===(f=data.prepareParticipate.tokenRewardCampaignTxResp)||void 0===f?void 0:f.signatureExpiredAt,!this.isBounty){t.next=77;break}if(this.user.hasEmail?this.$nuxt.$emit("rec-result",{status:"completed",trxId:E,operation:"claim",chain:C.input.chain,campaign:this.campaign}):this.$nuxt.$emit("email-dialog",!0),!this.isBounty||!this.isFcfs){t.next=74;break}return t.next=71,this.$listeners.getParticipants();case 71:this.$root.$emit("getCampaign"),t.next=75;break;case 74:this.$emit("refreshCampaign");case 75:t.next=122;break;case 77:if(!this.isTokenReward){t.next=87;break}if(!this.isFcfs&&!this.wonTheTokenRaffle){t.next=83;break}return t.next=81,Object(G.b)({_vue:this,chain:this.currentChain,campaignStrID:this.campaignID,_cid:this.campaignNumID,_dummyId:L,_expiredAt:M,_claimTo:this.account,_signature2:R,contractAddress:(null===(v=this.campaign.tokenRewardContract)||void 0===v?void 0:v.address)||"",account:this.account,nonce:A,campaign:this.campaign,$store:this.$store});case 81:t.next=84;break;case 83:this.user.hasEmail?this.$nuxt.$emit("rec-result",{status:"completed",trxId:E,operation:"claim",chain:C.input.chain,campaign:this.campaign}):this.$nuxt.$emit("email-dialog",!0);case 84:this.$emit("refreshCampaign"),t.next=122;break;case 87:if(!this.isLoyaltyPoint&&!this.isLoyaltyPointMysteryBox){t.next=92;break}console.log("loyalty point claim"),this.campaign&&(this.$nuxt.$emit("rec-result",{status:"completed",trxId:E,operation:"claim",chain:C.input.chain,campaign:this.campaign,claimedPoints:data.prepareParticipate.loyaltyPointsTxResp.TotalClaimedPoints}),this.$nuxt.$emit("trx-sending",{operation:"claim",id:this.campaign.id,mintCount:this.canClaimNum})),t.next=122;break;case 92:if(!this.isGasless||this.gaslessOutOfBalance){t.next=101;break}if(!(null===(y=data.prepareParticipate.metaTxResp)||void 0===y?void 0:y.reqQueueing)){t.next=98;break}return t.next=97,this.claimGaslessCampaign(data.prepareParticipate);case 97:return t.abrupt("return");case 98:this.campaign&&(this.$nuxt.$emit("rec-result",{status:"completed",trxId:E,operation:"claim",chain:C.input.chain,campaign:this.campaign}),this.$nuxt.$emit("trx-sending",{operation:"claim",id:this.campaign.id})),t.next=122;break;case 101:if(!this.isApotsCampaign){t.next=106;break}return t.next=104,Object(P.d)(this,$,T,0,F,1,B,R,this.account,this.currentChain,this.campaignID,A,this.campaign,this.connectMethod);case 104:t.next=122;break;case 106:if(!this.isSeiCampaign){t.next=111;break}return t.next=109,Object(P.g)(this,this.campaign,T,j,this.account,R,this.currentChain,A,$);case 109:t.next=122;break;case 111:if(!(j>0)){t.next=118;break}return t.next=114,this.getFeeInfo(Z.Claim);case 114:W=t.sent,Object(P.i)(this,this.currentChain,W.platformFee,this.campaignID,this.campaignNumID,$,T,D,this.account,"",R,I,j,this.$store,A,this.campaign),t.next=122;break;case 118:return t.next=120,this.getFeeInfo(Z.Claim);case 120:U=t.sent,Object(P.h)(this,this.currentChain,U.platformFee,this.campaignID,this.campaignNumID,$,T,D,this.account,"",R,I,this.$store,A,this.campaign);case 122:data&&!data.prepareParticipate.allow&&this.$errorPlain(data.prepareParticipate.disallowReason),this.claimLoading=!1,t.next=131;break;case 126:t.prev=126,t.t0=t.catch(0),console.log(t.t0),this.claimLoading=!1,this.$gtag.event("gtm_campaign_claim_fail",{message:t.t0.message,errorcode:t.t0.code||500});case 131:case"end":return t.stop()}}),t,this,[[0,126]])}))),function(){return v.apply(this,arguments)})},{key:"onGaslessToGasTrxResult",value:function(t){"cancel"===t.status&&(this.isClaimGaslessWithOwnFee=!1),"loading"!==t.status&&this.$nuxt.$off("rec-result",this.onGaslessToGasTrxResult)}},{key:"handleConnectDiscord",value:function(){this.$router.push({path:"/accountSetting?tab=SocialLinlk"})}},{key:"isGuildMember",value:(f=Object(o.a)(regeneratorRuntime.mark((function t(){var e,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$apollo.query({query:H.a,fetchPolicy:"network-only",variables:{guildId:this.campaign.space.discordGuildID}});case 3:if(e=t.sent,!(data=e.data)||!data.isGuildMember){t.next=7;break}return t.abrupt("return",data.isGuildMember);case 7:t.next=11;break;case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return f.apply(this,arguments)})},{key:"handleJoinDiscord",value:function(){var t;Object(K.a)(Object(Q.b)((null===(t=this.campaign.rewardInfo.discordRole)||void 0===t?void 0:t.inviteLink)||""),"__blank"),this.$nuxt.$emit("setDiscordDialog",{discordDialog:!1})}},{key:"claimExternal",value:(d=Object(o.a)(regeneratorRuntime.mark((function t(){var e,n,o,c,data,l,h,m,d,f,v,y,x;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.claimLoading=!0,t.next=4,Object(S.a)();case 4:if(n=t.sent){t.next=8;break}return this.claimLoading=!1,t.abrupt("return");case 8:return o={input:{signature:"",campaignID:null===(e=this.campaign)||void 0===e?void 0:e.id,address:this.account,mintCount:1,chain:this.campaign.chain,captcha:{lotNumber:n.lot_number,captchaOutput:n.captcha_output,passToken:n.pass_token,genTime:n.gen_time}}},t.next=11,this.$apollo.mutate({mutation:N.a,variables:o});case 11:if(c=t.sent,data=c.data,this.claimLoading=!1,!data){t.next=21;break}if(!(l=data.prepareParticipate.extLinkResp).error){t.next=20;break}throw l.error;case 20:if(data.prepareParticipate.allow){for(h=JSON.parse(l.data),m="",d=0,f=Object.entries(h);d<f.length;d++)v=Object(r.a)(f[d],2),y=v[0],x=v[1],m+="".concat(y?"".concat(y,":"):"").concat(x," </br></br>");this.$nuxt.$emit("showBackResult",m)}else this.$errorPlain(data.prepareParticipate.disallowReason);case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(0),this.claimLoading=!1,this.$gtag.event("gtm_campaign_claim_fail",{message:t.t0.message,errorcode:t.t0.code||500});case 27:case"end":return t.stop()}}),t,this,[[0,23]])}))),function(){return d.apply(this,arguments)})},{key:"claimAirDrop",value:(m=Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.claimLoading=!0,!(this.campaign&&this.campaign.gamification.airdrop&&this.campaign.gamification.airdrop.addressInfo)){t.next=6;break}return t.next=5,Object(A.a)(this.campaign.gamification.airdrop.addressInfo.index,this.account,this.campaign.gamification.airdrop.addressInfo.amount.amount,this.campaign.gamification.airdrop.addressInfo.proofs,this.campaign.gamification.airdrop.contractAddress);case 5:this.airDropIsClaimed=!0;case 6:this.claimLoading=!1,t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),this.$store.commit("setSnackbar",{state:C.SnackbarStatus.ERROR,body:{msg:"Claim Failed"},type:C.snackbarType.Default}),this.claimLoading=!1;case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return m.apply(this,arguments)})},{key:"claimOptIn",value:(n=Object(o.a)(regeneratorRuntime.mark((function t(){var e,n,r,o,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.claimLoading=!0,t.next=4,Object(S.a)();case 4:if(n=t.sent){t.next=8;break}return this.claimLoading=!1,t.abrupt("return");case 8:return r={input:{signature:"",campaignID:null===(e=this.campaign)||void 0===e?void 0:e.id,address:this.account,mintCount:1,chain:this.campaign.chain,captcha:{lotNumber:n.lot_number,captchaOutput:n.captcha_output,passToken:n.pass_token,genTime:n.gen_time}}},t.next=11,this.$apollo.mutate({mutation:N.a,variables:r});case 11:o=t.sent,(data=o.data)&&(data.prepareParticipate.allow?(this.$successPlain("Claim Success"),this.usedCount+=1,this.claimLoading=!1,this.successOptIn()):this.$errorPlain(data.prepareParticipate.disallowReason)),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),this.claimLoading=!1,this.$gtag.event("gtm_campaign_claim_fail",{message:t.t0.message,errorcode:t.t0.code||500});case 20:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(){return n.apply(this,arguments)})},{key:"successOptIn",value:function(){this.user.username||this.$nuxt.$emit("trx-result",{status:"completed",operation:"claim",isOptIn:!0})}},{key:"onAccount",value:function(t){t&&this.tokenAddress&&this.getAllowance()}},{key:"onTokenAddress",value:function(t){t&&this.account&&this.getAllowance()}},{key:"onErc20Fee",value:(e=Object(o.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}return t.next=3,Object(P.n)(this.erc20FeeTokenAddr);case 3:this.erc20FeeToken=t.sent;case 4:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),it}(Object(v.Mixins)(R.a));tt([Object(v.Prop)({required:!0})],et.prototype,"campaign",void 0),tt([Object(v.Prop)({required:!0})],et.prototype,"canClaimNum",void 0),tt([Object(v.Prop)({required:!0,default:0})],et.prototype,"maxCount",void 0),tt([Object(v.Prop)({required:!0})],et.prototype,"usedCount",void 0),tt([Object(v.Prop)({required:!1,default:!1})],et.prototype,"isChild",void 0),tt([Object(v.Prop)({required:!1,default:!1})],et.prototype,"inDetail",void 0),tt([Object(v.Watch)("account",{immediate:!0})],et.prototype,"onAccount",null),tt([Object(v.Watch)("tokenAddress",{immediate:!0})],et.prototype,"onTokenAddress",null),tt([Object(v.Watch)("erc20Fee",{immediate:!0})],et.prototype,"onErc20Fee",null);var at=et=tt([Object(v.Component)({components:{GalaxyButton:y.default,ApproveBtn:x.default,InputWithBtn:O.default,CampaignClaimNum:k.default,VueCountdown:$.a,GalaxyDialogClassic:Y.default}})],et),it=(n(3111),n(32)),component=Object(it.a)(at,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("client-only",[e("div",{staticClass:"campaign-button-container"},[t.isRaffle&&t.countdownToStartTime&&t.inDetail?e("div",{staticClass:"countdown-wrapper d-flex justify-space-between align-center"},[e("div",{staticClass:"label"},[t._v("Raffle In")]),t._v(" "),e("VueCountdown",{attrs:{time:t.countdownToStartTime},on:{end:t.handleEnd},scopedSlots:t._u([{key:"default",fn:function(n){var r=n.days,o=n.hours,c=n.minutes,l=n.seconds;return[e("div",{staticClass:"countdown d-flex"},[e("div",{staticClass:"countdown-item"},[e("div",{staticClass:"num"},[t._v(t._s(r))]),t._v(" "),e("div",{staticClass:"unit"},[t._v(t._s(r>1?"Days":"Day"))])]),t._v(" "),e("div",{staticClass:"countdown-item"},[e("div",{staticClass:"num"},[t._v(t._s(o))]),t._v(" "),e("div",{staticClass:"unit"},[t._v("Hours")])]),t._v(" "),e("div",{staticClass:"countdown-item"},[e("div",{staticClass:"num"},[t._v(t._s(c))]),t._v(" "),e("div",{staticClass:"unit"},[t._v("Minutes")])]),t._v(" "),e("div",{staticClass:"countdown-item"},[e("div",{staticClass:"num"},[t._v(t._s(l))]),t._v(" "),e("div",{staticClass:"unit"},[t._v("Seconds")])])])]}}],null,!1,2884161603)})],1):t.isRaffle&&t.countdownToClaimEndTime&&t.inDetail&&t.wonTheTokenRaffle?e("div",{staticClass:"countdown-wrapper d-flex justify-space-between align-center"},[e("div",{staticClass:"label"},[t._v("Claim End Time")]),t._v(" "),e("VueCountdown",{attrs:{time:t.countdownToClaimEndTime},on:{end:t.handleEnd},scopedSlots:t._u([{key:"default",fn:function(n){var r=n.days,o=n.hours,c=n.minutes,l=n.seconds;return[e("div",{staticClass:"countdown d-flex"},[e("div",{staticClass:"countdown-item"},[e("div",{staticClass:"num"},[t._v(t._s(r))]),t._v(" "),e("div",{staticClass:"unit"},[t._v(t._s(r>1?"Days":"Day"))])]),t._v(" "),e("div",{staticClass:"countdown-item"},[e("div",{staticClass:"num"},[t._v(t._s(o))]),t._v(" "),e("div",{staticClass:"unit"},[t._v("Hours")])]),t._v(" "),e("div",{staticClass:"countdown-item"},[e("div",{staticClass:"num"},[t._v(t._s(c))]),t._v(" "),e("div",{staticClass:"unit"},[t._v("Minutes")])]),t._v(" "),e("div",{staticClass:"countdown-item"},[e("div",{staticClass:"num"},[t._v(t._s(l))]),t._v(" "),e("div",{staticClass:"unit"},[t._v("Seconds")])])])]}}])})],1):t._e(),t._v(" "),e("div",{staticClass:"op-section"},[e("div",[t.envWrong&&t.isGoing?e("GalaxyButton",t._b({attrs:{block:"",color:"primary"},on:{click:t.addChain}},"GalaxyButton",t.$attrs,!1),[t._v("\n          "+t._s(t.claimText)+"\n        ")]):[t.isForge?[t.forgeApprove&&!t.showBuyApprove?e("GalaxyButton",t._b({attrs:{block:"",color:"primary",disabled:!t.canForge},on:{click:t.forgeHandler}},"GalaxyButton",t.$attrs,!1),[t._v("\n              "+t._s(t.claimText)+"\n            ")]):e("ApproveBtn",t._b({attrs:{block:"","claim-disabled":!t.canForge,"approve-handler":t.approveForge},on:{onApprove:t.onApproveForge}},"ApproveBtn",t.$attrs,!1))]:t.showBuyApprove?[e("ApproveBtn",{attrs:{block:"","claim-disabled":t.claimDisabled,"approve-handler":t.approveAdopt},on:{onApprove:t.onApprove}})]:t.isTokenReward&&t.isRaffle?[t.isTokenRaffleParticipateEnded?[t.$attrs["raffle-in-progress"]&&t.inDetail&&t.isParticipated?e("div",{class:["custom-button lose-button",t.$attrs.large?"large":""]},[t._v("\n                Raffle drawing in progress...\n              ")]):t.wonTheTokenRaffle?e("GalaxyButton",t._b({attrs:{block:"",color:"primary",disabled:t.claimDisabled,loading:t.claimLoading},on:{click:t.claimHandler}},"GalaxyButton",t.$attrs,!1),[t._v("\n                "+t._s(t.claimText)+"\n              ")]):t.claimedTheTokenRaffle?e("div",{class:["custom-button win-button",t.$attrs.large?"large":""]},[t._v("\n                Claimed\n              ")]):t.loseTheTokenRaffle?e("div",{class:["custom-button lose-button",t.$attrs.large?"large":""]},[t._v("\n                Sorry, you didn't win!\n              ")]):t.isParticipated?e("div",{class:["custom-button lose-button",t.$attrs.large?"large":""]},[t._v("\n                Expired\n              ")]):e("div",{class:["custom-button lose-button",t.$attrs.large?"large":""]},[t._v("\n                Campaign Ended\n              ")])]:[t.isParticipated?e("div",{class:["custom-button lose-button",t.$attrs.large?"large":""]},[t._v("\n                You've entered the raffle!\n              ")]):e("GalaxyButton",t._b({attrs:{block:"",color:"primary",disabled:t.claimDisabled,loading:t.claimLoading},on:{click:t.claimHandler}},"GalaxyButton",t.$attrs,!1),[t._v("\n                "+t._s(t.claimText)+"\n              ")])]]:t.isBounty&&t.isParticipated?[t.isWon?e("div",{class:["custom-button win-button",t.$attrs.large?"large":""]},[t._v("\n              You Won the Reward\n            ")]):[!t.isEnded&&t.countdownToStartTime>0?e("div",{class:["custom-button lose-button",t.$attrs.large?"large":""]},[t._v("\n                You've entered the raffle!\n              ")]):t.inRaffle?e("div",{class:["custom-button lose-button",t.$attrs.large?"large":""]},[t._v("\n                Raffle drawing in progress...\n              ")]):e("div",{class:["custom-button lose-button",t.$attrs.large?"large":""]},[t._v("\n                Sorry, you didn't win!\n              ")])]]:[e("div",{},[t.canBatch?e("InputWithBtn",t._b({attrs:{block:"",color:"primary",type:"number",min:"1",max:t.canClaimNum,"show-max":t.canClaimNum>0,disabled:t.claimDisabled,loading:t.claimLoading},on:{click:t.claimHandler,inputChange:t.onInputBatchNumChange}},"InputWithBtn",t.$attrs,!1),[t._v("\n                "+t._s(t.claimText)+"\n              ")]):e("GalaxyButton",t._b({attrs:{block:"",color:"primary",disabled:t.claimDisabled,loading:t.claimLoading},on:{click:t.claimHandler}},"GalaxyButton",t.$attrs,!1),[t._v("\n                "+t._s(t.claimText)+"\n              ")])],1)]]],2),t._v(" "),!t.isChild&&t.isFeeTips?e("div",{staticClass:"fee-tips flex-column flex-all-center"},[e("div",{staticClass:"flex-all-center width-100"},[t.erc20Fee>0?e("div",{staticClass:"flex-align-center text-lighten-1 text-14-regular flex-1"},[e("i",{staticClass:"iconfont icon-platform-fee-icon"}),t._v(" "),e("span",{staticClass:"ml-1"},[t._v(t._s(t._f("commaForDigits")(t._f("digitFixed")(t.erc20Fee*t.inputBatchNum))))]),t._v(" "),e("a",{staticClass:"text-highlight clickable ml-1",attrs:{href:t.tokenExploreUrl,target:"_blank",rel:"noopener noreferrer"}},[t._v(t._s(t.erc20FeeToken))])]):t.platformFee>0?e("div",{staticClass:"flex-align-center text-lighten-1 text-14-regular flex-1"},[e("i",{staticClass:"iconfont icon-platform-fee-icon"}),t._v(" "),e("span",{staticClass:"ml-1"},[t._v(t._s(t._f("commaForDigits")(t._f("digitFixed")(t.platformFee*t.inputBatchNum,5))))]),t._v(" "),e("span",{staticClass:"text-highlight"},[t._v(t._s(t.platformFeeToken))])]):t._e(),t._v(" "),t.showClaimNumberInfo?e("CampaignClaimNum",{attrs:{campaign:t.campaign,"can-claim-num":t.canClaimNum,"max-count":t.maxCount,"used-count":t.usedCount}}):t._e()],1),t._v(" "),e("div",{staticClass:"flex-align-center text-lighten-1 text-12-regular oat-tips"},[t.isBounty&&t.isWon?e("span",[e("i",{staticClass:"iconfont icon-gasless-icon"}),t._v("\n            Reward distribution will be done by\n            "),e("span",{staticClass:"text-bold text-white"},[t._v(t._s(t.campaign.space.name))])]):(t.isOat||t.isNFT)&&t.isGasless&&!t.gaslessOutOfBalance?e("span",[e("i",{staticClass:"iconfont icon-gasless-icon"}),t._v("\n            Minting transaction fee is covered by\n            "),e("span",{staticClass:"text-highlight"},[t._v(t._s(t.coveredByText))])]):t._e()])]):t._e()]),t._v(" "),e("GalaxyDialogClassic",{attrs:{"show-dialog":t.isShowOutOfBalanceDialog,title:"Friendly Reminder",content:"Oops! This campaign offered a gasless experience thanks to its host, but this Space's Gas Station is now empty. If you would like to mint right now, you'll be charged with gas fee. <br /><br />Do you wish to proceed?","confirm-title":"Confirm","cancel-title":"Cancel","on-confirm":t.claimGaslessWithOwnFee,"on-cancel":function(){return t.isShowOutOfBalanceDialog=!1}}})],1)])}),[],!1,null,"af8d9720",null);e.default=component.exports;installComponents(component,{GalaxyButton:n(152).default,ApproveBtn:n(2819).default,InputWithBtn:n(2820).default,CampaignClaimNum:n(2734).default,GalaxyDialogClassic:n(701).default})},2920:function(t,e,n){var content=n(3258);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(41).default)("5b4eb007",content,!0,{sourceMap:!1})},2952:function(t,e,n){"use strict";n.r(e);var r=n(2414),o=(n(58),n(11)),c=n(12),l=n(19),h=n(24),m=n(17),d=n(8),f=(n(30),n(16),n(43),n(99),n(114),n(14)),v=n(2998),y=n.n(v),x=n(2550),k=n.n(x);function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(m.a)(t);if(e){var o=Object(m.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(h.a)(this,n)}}var w=function(t,e,n,desc){var r,o=arguments.length,c=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(d.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(c=(o<3?r(c):o>3?r(e,n,c):r(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},O=function(t){Object(l.a)(n,t);var e=C(n);function n(){var t;return Object(o.a)(this,n),(t=e.apply(this,arguments)).showResult=!1,t.dialogId=(new Date).getTime(),t.content="",t}return Object(c.a)(n,[{key:"beforeMount",value:function(){this.$nuxt.$on("showBackResult",this.show)}},{key:"show",value:function(content){var t=this;this.showResult=!0,this.content=content;var e=y()(this.content).replace(/<a /g,'<a target="_blank" rel="noopener noreferrer" ');setTimeout((function(){document.getElementById(t.dialogId).innerHTML=k()(e)}),0),this.showResult=!0}},{key:"hide",value:function(){this.showResult=!1}}]),n}(f.Vue);w([Object(f.Prop)({type:String,required:!1,default:"Exclusive Content"})],O.prototype,"title",void 0),w([Object(f.Prop)({required:!1,default:468})],O.prototype,"maxWidth",void 0);var R=O=w([f.Component],O),T=(n(3257),n(32)),component=Object(T.a)(R,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e(r.a,{attrs:{"max-width":t.maxWidth,"overlay-opacity":"1"},model:{value:t.showResult,callback:function(e){t.showResult=e},expression:"showResult"}},[e("div",{staticClass:"g-popup-content flex-column flex-align-center"},[e("i",{staticClass:"iconfont icon-close text-16-regular clickable popup-close-icon",on:{click:function(e){t.showResult=!1}}}),t._v(" "),e("div",[e("div",{staticClass:"text-24-bold title-box",style:{width:t.$vuetify.breakpoint.xsOnly?"300px":"468px"}},[t._v("\n        "+t._s(t.title)+"\n      ")]),t._v(" "),e("div",{staticClass:"text-lighten-1 mt-4",attrs:{id:t.dialogId}},[t._v("\n        "+t._s(t.content)+"\n      ")])])])])}),[],!1,null,"9cfaaa0a",null);e.default=component.exports},3111:function(t,e,n){"use strict";n(2828)},3112:function(t,e,n){var r=n(40)((function(i){return i[1]}));r.push([t.i,".campaign-button-container .countdown-wrapper[data-v-af8d9720]{width:100%;margin-bottom:12px;flex-direction:column}@media(max-width:1024px){.campaign-button-container .countdown-wrapper[data-v-af8d9720]{flex-direction:row}}.campaign-button-container .countdown-wrapper .label[data-v-af8d9720]{font-style:normal;font-weight:600;font-size:14px;line-height:22px;color:#fff;text-align:center}.campaign-button-container .countdown-wrapper .countdown[data-v-af8d9720]{height:54px;margin-top:16px}.campaign-button-container .countdown-wrapper .countdown-item[data-v-af8d9720]{width:68px;width:80px;display:flex;flex-direction:column;justify-content:space-between;align-items:center;flex:1;border-right:1px solid #1b1e24}@media(max-width:1024px){.campaign-button-container .countdown-wrapper .countdown-item[data-v-af8d9720]{width:68px}}.campaign-button-container .countdown-wrapper .countdown-item .num[data-v-af8d9720]{font-weight:700;font-size:24px;line-height:34px;color:#fff}.campaign-button-container .countdown-wrapper .countdown-item .unit[data-v-af8d9720]{font-size:12px;line-height:20px;color:#9097a6}.campaign-button-container .countdown-wrapper .countdown-item[data-v-af8d9720]:last-child{border-right:0}.campaign-button-container .custom-button[data-v-af8d9720]{width:100%;height:52px;display:flex;justify-content:center;align-items:center;font-weight:700;font-size:16px;line-height:24px;border:1px solid #20242b;border-radius:8px}.campaign-button-container .custom-button.win-button[data-v-af8d9720]{color:#00b58b}.campaign-button-container .custom-button.lose-button[data-v-af8d9720]{background:#0057ff;-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-fill-color:transparent}.campaign-button-container .custom-button.large[data-v-af8d9720]{height:40px}.campaign-button-container .fee-tips[data-v-af8d9720]{margin-top:12px}.campaign-button-container .oat-tips[data-v-af8d9720]{font-size:14px!important;padding-top:2px}.campaign-button-container .icon-platform-fee-icon[data-v-af8d9720]{font-size:14px!important}@media only screen and (max-width:959.98px){.campaign-button-container .fee-tips[data-v-af8d9720]{margin:0 0 12px}.campaign-button-container .oat-tips[data-v-af8d9720]{font-size:12px!important}.campaign-button-container .op-section[data-v-af8d9720]{display:flex;flex-flow:column-reverse}}",""]),r.locals={},t.exports=r},3257:function(t,e,n){"use strict";n(2920)},3258:function(t,e,n){var r=n(40)((function(i){return i[1]}));r.push([t.i,".title-box[data-v-9cfaaa0a]{padding-bottom:16px!important;border-bottom:1px solid var(--v-border-base)}.content-line[data-v-9cfaaa0a]{height:28px;width:264px;background-color:var(--v-border-lighten1);margin-top:12px}",""]),r.locals={},t.exports=r}}]);