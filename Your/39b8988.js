(window.webpackJsonp=window.webpackJsonp||[]).push([[1108],{1050:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorCode=n.ConnectError=void 0;var r=t(1051),o=function(){function e(code,e){this.code=code,this.message=e||c[code],!r.DFLAG&&window&&window.localStorage&&delete window.localStorage[r.C_ACCESS_TOKEN_KEY]}return e.prototype.printError=function(){console.error(this.message)},e}();n.ConnectError=o,function(e){e.EmptyNamespace="EmptyNamespace",e.EmptyEthProvider="EmptyEthProvider",e.EmptyAuthProvider="EmptyAuthProvider",e.NetworkError="NetworkError",e.GraphqlError="GraphqlError",e.CeramicError="CeramicError",e.AuthProviderError="AuthProviderError",e.SignJwtError="SignJwtError"}(n.ErrorCode||(n.ErrorCode={}));var c={EmptyNamespace:"Namespace can not be empty",EmptyEthProvider:"Eth provider can not be empty",EmptyAuthProvider:"Could not find authProvider",NetworkError:"",GraphqlError:"",CeramicError:"",AuthProviderError:"",SignJwtError:""}},1051:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.C_ACCESS_TOKEN_KEY=n.DFLAG=void 0,n.DFLAG=!1,n.C_ACCESS_TOKEN_KEY="CYBERCONNECT_ACCESS_TOKEN"},1052:function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function d(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,d)}h((r=r.apply(e,n||[])).next())}))},o=this&&this.__generator||function(e,body){var n,t,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,t&&(r=2&c[0]?t.return:c[0]?t.throw||((r=t.return)&&r.call(t),0):t.next)&&!(r=r.call(t,c[1])).done)return r;switch(t=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,t=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],t=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getSigningKeySignature=n.getAddressByProvider=n.safeSend=n.encodeRpcMessage=void 0;var l=t(599),d=c(t(63)),h=t(2),f=t(158);n.encodeRpcMessage=function(e,n){return{jsonrpc:"2.0",id:1,method:e,params:n}};n.safeSend=function(e,t,r){if(null==r&&(r=[]),e.request)return e.request({method:t,params:r}).then((function(e){return e}),(function(e){throw e}));if(e.sendAsync||e.send){var o=(e.sendAsync?e.sendAsync:e.send).bind(e),c=(0,n.encodeRpcMessage)(t,r);return new Promise((function(e,n){o(c,(function(t,r){if(t&&n(t),r.error){var o=new Error(r.error.message);o.code=r.error.code,o.data=r.error.data,n(o)}e(r.result)}))}))}throw new Error("Unsupported provider; provider must implement one of the following methods: send, sendAsync, request")};n.getAddressByProvider=function(e,t){return r(void 0,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:switch(t){case l.Blockchain.ETH:return[3,1];case l.Blockchain.SOLANA:return[3,5]}return[3,6];case 1:return"function"!=typeof e.getSigner?[3,3]:[4,e.getSigner().getAddress()];case 2:return[2,o.sent()];case 3:return[4,(0,n.safeSend)(e,"eth_accounts")];case 4:return(r=o.sent())&&r[0]?[2,r[0]]:[2,""];case 5:return[2,e.publicKey.toString()];case 6:return[2,""];case 7:return[2]}}))}))};n.getSigningKeySignature=function(e,t,c,address){return r(void 0,void 0,void 0,(function(){var r,y;return o(this,(function(o){switch(o.label){case 0:return t!==l.Blockchain.ETH?[3,4]:e.isAuthereum?[2,e.signMessageWithSigningKey(c)]:"function"!=typeof e.getSigner?[3,2]:[4,e.getSigner().signMessage(c)];case 1:return[2,o.sent()];case 2:return[4,(0,n.safeSend)(e,"personal_sign",[(0,h.hexlify)((0,f.toUtf8Bytes)(c)),address])];case 3:return[2,o.sent()];case 4:return t!==l.Blockchain.SOLANA?[3,6]:(y=(r=d.default).encode,[4,e.signMessage((new TextEncoder).encode(c))]);case 5:return[2,y.apply(r,[o.sent()])];case 6:return[2,""]}}))}))}},141:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isUint8Array=n.isNonNullObject=n.sleep=n.assertDefinedAndNotNull=n.assertDefined=n.assert=n.arrayContentStartsWith=n.arrayContentEquals=void 0;var r=t(1692);Object.defineProperty(n,"arrayContentEquals",{enumerable:!0,get:function(){return r.arrayContentEquals}}),Object.defineProperty(n,"arrayContentStartsWith",{enumerable:!0,get:function(){return r.arrayContentStartsWith}});var o=t(1693);Object.defineProperty(n,"assert",{enumerable:!0,get:function(){return o.assert}}),Object.defineProperty(n,"assertDefined",{enumerable:!0,get:function(){return o.assertDefined}}),Object.defineProperty(n,"assertDefinedAndNotNull",{enumerable:!0,get:function(){return o.assertDefinedAndNotNull}});var c=t(1694);Object.defineProperty(n,"sleep",{enumerable:!0,get:function(){return c.sleep}});var l=t(1695);Object.defineProperty(n,"isNonNullObject",{enumerable:!0,get:function(){return l.isNonNullObject}}),Object.defineProperty(n,"isUint8Array",{enumerable:!0,get:function(){return l.isUint8Array}})},1648:function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function d(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,d)}h((r=r.apply(e,n||[])).next())}))},o=this&&this.__generator||function(e,body){var n,t,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,t&&(r=2&c[0]?t.return:c[0]?t.throw||((r=t.return)&&r.call(t),0):t.next)&&!(r=r.call(t,c[1])).done)return r;switch(t=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,t=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],t=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t(1649),l=t(1650),d=t(1050),h=t(599),f=t(1052),y=t(677),v=t(1051),w=t(1651),m=function(){function e(e){this.address="",this.signature="",this.chain=h.Blockchain.ETH,this.chainRef="",this.provider=null,this.signingMessageEntity="";var n=e.provider,t=e.namespace,r=e.env,o=e.chainRef,l=e.chain,f=e.signingMessageEntity;if(!t)throw new d.ConnectError(d.ErrorCode.EmptyNamespace);this.namespace=t,this.endpoint=c.endpoints[r||y.Env.PRODUCTION],this.chain=l||h.Blockchain.ETH,this.chainRef=o||"",this.provider=n,this.signingMessageEntity=f,delete window.localStorage[v.C_ACCESS_TOKEN_KEY]}return e.prototype.connect=function(e,n,t){var c,f,y,v;return void 0===n&&(n=""),void 0===t&&(t=h.ConnectionType.FOLLOW),r(this,void 0,void 0,(function(){var r,h,m,S,E,C,A;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,8,,9]),r=this,[4,this.getAddress()];case 1:return r.address=o.sent(),[4,this.authWithSigningKey()];case 2:return o.sent(),h={name:t.toLowerCase(),from:this.address,to:e,namespace:this.namespace,network:this.chain,timestamp:Date.now(),alias:n},[4,(0,w.signWithSigningKey)(JSON.stringify(h),this.address)];case 3:return m=o.sent(),[4,(0,w.getPublicKey)(this.address)];case 4:return S=o.sent(),E={fromAddr:this.address,toAddr:e,alias:n,namespace:this.namespace,signature:m,signingKey:S,operation:JSON.stringify(h),network:this.chain,type:t},[4,(0,l.follow)(E,this.endpoint.cyberConnectApi)];case 5:return C=o.sent(),"INVALID_SIGNATURE"!==(null===(c=null==C?void 0:C.data)||void 0===c?void 0:c.connect.result)?[3,7]:[4,(0,w.clearSigningKey)()];case 6:throw o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,null===(f=null==C?void 0:C.data)||void 0===f?void 0:f.connect.result);case 7:if("SUCCESS"!==(null===(y=null==C?void 0:C.data)||void 0===y?void 0:y.connect.result))throw new d.ConnectError(d.ErrorCode.GraphqlError,null===(v=null==C?void 0:C.data)||void 0===v?void 0:v.connect.result);return[3,9];case 8:throw A=o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,A.message||A);case 9:return[2]}}))}))},e.prototype.batchConnect=function(e,n){var t,c,f,y,v;return void 0===n&&(n=h.ConnectionType.FOLLOW),r(this,void 0,void 0,(function(){var h,m,S,E,C,A,N,k,K=this;return o(this,(function(O){switch(O.label){case 0:return O.trys.push([0,8,,9]),h=this,[4,this.getAddress()];case 1:return h.address=O.sent(),[4,this.authWithSigningKey()];case 2:return O.sent(),m=Date.now(),S=[],e.forEach((function(e){var t={name:n.toLowerCase(),from:K.address,to:e,namespace:K.namespace,network:K.chain,timestamp:m};S.push(new Promise((function(c){return r(K,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return[4,(0,w.signWithSigningKey)(JSON.stringify(t),this.address)];case 1:return r=o.sent(),c({toAddr:e,signature:r,operation:JSON.stringify(t),type:n}),[2]}}))}))})))})),[4,Promise.all(S)];case 3:return E=O.sent(),[4,(0,w.getPublicKey)(this.address)];case 4:return C=O.sent(),A={fromAddr:this.address,namespace:this.namespace,signingInputs:E,signingKey:C,network:this.chain},[4,(0,l.batchFollow)(A,this.endpoint.cyberConnectApi)];case 5:return N=O.sent(),"INVALID_SIGNATURE"!==(null===(t=null==N?void 0:N.data)||void 0===t?void 0:t.batchConnect.result)?[3,7]:[4,(0,w.clearSigningKey)()];case 6:throw O.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,null===(c=null==N?void 0:N.data)||void 0===c?void 0:c.batchConnect.result);case 7:if("SUCCESS"!==(null===(f=null==N?void 0:N.data)||void 0===f?void 0:f.batchConnect.result))throw new d.ConnectError(d.ErrorCode.GraphqlError,null===(y=null==N?void 0:N.data)||void 0===y?void 0:y.batchConnect.result);return[2,null===(v=null==N?void 0:N.data)||void 0===v?void 0:v.batchConnect];case 8:throw k=O.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,k.message||k);case 9:return[2]}}))}))},e.prototype.disconnect=function(e,n){var t,c,h,f;return void 0===n&&(n=""),r(this,void 0,void 0,(function(){var n,r,y,v,m,S,E;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,8,,9]),n=this,[4,this.getAddress()];case 1:return n.address=o.sent(),[4,this.authWithSigningKey()];case 2:return o.sent(),r={name:"unfollow",from:this.address,to:e,namespace:this.namespace,network:this.chain,timestamp:Date.now()},[4,(0,w.signWithSigningKey)(JSON.stringify(r),this.address)];case 3:return y=o.sent(),[4,(0,w.getPublicKey)(this.address)];case 4:return v=o.sent(),m={fromAddr:this.address,toAddr:e,namespace:this.namespace,signature:y,signingKey:v,operation:JSON.stringify(r),network:this.chain},[4,(0,l.unfollow)(m,this.endpoint.cyberConnectApi)];case 5:return S=o.sent(),"INVALID_SIGNATURE"!==(null===(t=null==S?void 0:S.data)||void 0===t?void 0:t.disconnect.result)?[3,7]:[4,(0,w.clearSigningKey)()];case 6:throw o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,null===(c=null==S?void 0:S.data)||void 0===c?void 0:c.disconnect.result);case 7:if("SUCCESS"!==(null===(h=null==S?void 0:S.data)||void 0===h?void 0:h.disconnect.result))throw new d.ConnectError(d.ErrorCode.GraphqlError,null===(f=null==S?void 0:S.data)||void 0===f?void 0:f.disconnect.result);return[3,9];case 8:throw E=o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,E.message||E);case 9:return[2]}}))}))},e.prototype.setAlias=function(e,n){var t,c,h,f;return void 0===n&&(n=""),r(this,void 0,void 0,(function(){var r,y,v,m,S,E,C;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,8,,9]),r=this,[4,this.getAddress()];case 1:return r.address=o.sent(),[4,this.authWithSigningKey()];case 2:return o.sent(),y={name:"follow",from:this.address,to:e,namespace:this.namespace,network:this.chain,alias:n,timestamp:Date.now()},[4,(0,w.signWithSigningKey)(JSON.stringify(y),this.address)];case 3:return v=o.sent(),[4,(0,w.getPublicKey)(this.address)];case 4:return m=o.sent(),S={fromAddr:this.address,toAddr:e,alias:n,namespace:this.namespace,signature:v,signingKey:m,operation:JSON.stringify(y),network:this.chain},[4,(0,l.setAlias)(S,this.endpoint.cyberConnectApi)];case 5:return E=o.sent(),"INVALID_SIGNATURE"!==(null===(t=null==E?void 0:E.data)||void 0===t?void 0:t.alias.result)?[3,7]:[4,(0,w.clearSigningKey)()];case 6:throw o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,null===(c=null==E?void 0:E.data)||void 0===c?void 0:c.alias.result);case 7:if("SUCCESS"!==(null===(h=null==E?void 0:E.data)||void 0===h?void 0:h.alias.result))throw new d.ConnectError(d.ErrorCode.GraphqlError,null===(f=null==E?void 0:E.data)||void 0===f?void 0:f.alias.result);return[3,9];case 8:throw C=o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,C.message||C);case 9:return[2]}}))}))},e.prototype.bidirectionalConnect=function(e,n){var t,c,h,f;return r(this,void 0,void 0,(function(){var r,y,v,m,S,E,C;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,8,,9]),r=this,[4,this.getAddress()];case 1:return r.address=o.sent(),[4,this.authWithSigningKey()];case 2:return o.sent(),y={name:n,from:this.address,to:e,namespace:this.namespace,network:this.chain,timestamp:Date.now()},[4,(0,w.signWithSigningKey)(JSON.stringify(y),this.address)];case 3:return v=o.sent(),[4,(0,w.getPublicKey)(this.address)];case 4:return m=o.sent(),S={fromAddr:this.address,toAddr:e,namespace:this.namespace,signature:v,signingKey:m,operation:JSON.stringify(y),network:this.chain,instruction:n},[4,(0,l.biConnect)(S,this.endpoint.cyberConnectApi)];case 5:return E=o.sent(),"INVALID_SIGNATURE"!==(null===(t=null==E?void 0:E.data)||void 0===t?void 0:t.bidirectionalConnect.result)?[3,7]:[4,(0,w.clearSigningKey)()];case 6:throw o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,null===(c=null==E?void 0:E.data)||void 0===c?void 0:c.bidirectionalConnect.result);case 7:if("SUCCESS"!==(null===(h=null==E?void 0:E.data)||void 0===h?void 0:h.bidirectionalConnect.result))throw new d.ConnectError(d.ErrorCode.GraphqlError,null===(f=null==E?void 0:E.data)||void 0===f?void 0:f.bidirectionalConnect.message);return[3,9];case 8:throw C=o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,C.message||C);case 9:return[2]}}))}))},e.prototype.ackNotifications=function(e){var n,t,c,h;return r(this,void 0,void 0,(function(){var r,f,y,v,m,S,E;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,8,,9]),r=this,[4,this.getAddress()];case 1:return r.address=o.sent(),[4,this.authWithSigningKey()];case 2:return o.sent(),f={name:"ack_notifications",from:this.address,namespace:this.namespace,network:this.chain,notificationIds:e,timestamp:Date.now()},[4,(0,w.signWithSigningKey)(JSON.stringify(f),this.address)];case 3:return y=o.sent(),[4,(0,w.getPublicKey)(this.address)];case 4:return v=o.sent(),m={address:this.address,namespace:this.namespace,signature:y,signingKey:v,operation:JSON.stringify(f),network:this.chain,notificationIds:e},console.log("params",m),[4,(0,l.ackNotifications)(m,this.endpoint.cyberConnectApi)];case 5:return S=o.sent(),"INVALID_SIGNATURE"!==(null===(n=null==S?void 0:S.data)||void 0===n?void 0:n.ackNotifications.result)?[3,7]:[4,(0,w.clearSigningKey)()];case 6:throw o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,null===(t=null==S?void 0:S.data)||void 0===t?void 0:t.ackNotifications.result);case 7:if("SUCCESS"!==(null===(c=null==S?void 0:S.data)||void 0===c?void 0:c.ackNotifications.result))throw new d.ConnectError(d.ErrorCode.GraphqlError,null===(h=null==S?void 0:S.data)||void 0===h?void 0:h.ackNotifications.result);return[3,9];case 8:throw E=o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,E.message||E);case 9:return[2]}}))}))},e.prototype.ackAllNotifications=function(){var e,n,t,c;return r(this,void 0,void 0,(function(){var r,h,f,y,v,m,S,E;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,8,,9]),r=this,[4,this.getAddress()];case 1:return r.address=o.sent(),[4,this.authWithSigningKey()];case 2:return o.sent(),h=Date.now(),f={name:"ack_all_notifications",from:this.address,namespace:this.namespace,network:this.chain,timestamp:h},[4,(0,w.signWithSigningKey)(JSON.stringify(f),this.address)];case 3:return y=o.sent(),[4,(0,w.getPublicKey)(this.address)];case 4:return v=o.sent(),m={address:this.address,namespace:this.namespace,signature:y,signingKey:v,operation:JSON.stringify(f),network:this.chain,timestamp:h.toString()},console.log("params",m),[4,(0,l.ackAllNotifications)(m,this.endpoint.cyberConnectApi)];case 5:return S=o.sent(),"INVALID_SIGNATURE"!==(null===(e=null==S?void 0:S.data)||void 0===e?void 0:e.ackAllNotifications.result)?[3,7]:[4,(0,w.clearSigningKey)()];case 6:throw o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,null===(n=null==S?void 0:S.data)||void 0===n?void 0:n.ackAllNotifications.result);case 7:if("SUCCESS"!==(null===(t=null==S?void 0:S.data)||void 0===t?void 0:t.ackAllNotifications.result))throw new d.ConnectError(d.ErrorCode.GraphqlError,null===(c=null==S?void 0:S.data)||void 0===c?void 0:c.ackAllNotifications.result);return[3,9];case 8:throw E=o.sent(),new d.ConnectError(d.ErrorCode.GraphqlError,E.message||E);case 9:return[2]}}))}))},e.prototype.getAddress=function(){return r(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return this.address?[2,this.address]:(e=this,[4,(0,f.getAddressByProvider)(this.provider,this.chain)]);case 1:return[2,e.address=n.sent()]}}))}))},e.prototype.authWithSigningKey=function(){var e,n;return r(this,void 0,void 0,(function(){var t,r,c,h,y,v;return o(this,(function(o){switch(o.label){case 0:return[4,(0,w.hasSigningKey)(this.address)];case 1:return o.sent()?[2]:[4,(0,w.getPublicKey)(this.address)];case 2:return t=o.sent(),r="I authorize "+(this.signingMessageEntity||"CyberConnect")+" from this device using signing key:\n",c=""+r+t,h=this,[4,this.getAddress()];case 3:h.address=o.sent(),o.label=4;case 4:return o.trys.push([4,9,,10]),[4,(0,f.getSigningKeySignature)(this.provider,this.chain,c,this.address)];case 5:return(y=o.sent())?[4,(0,l.registerSigningKey)({address:this.address,signature:y,message:c,network:this.chain,url:this.endpoint.cyberConnectApi})]:[3,7];case 6:if(v=o.sent(),"SUCCESS"!==(null===(e=null==v?void 0:v.data)||void 0===e?void 0:e.registerKey.result))throw new d.ConnectError(d.ErrorCode.GraphqlError,null===(n=null==v?void 0:v.data)||void 0===n?void 0:n.alias.result);return[3,8];case 7:throw new Error("signingKeySignature is empty");case 8:return[3,10];case 9:throw o.sent(),(0,w.clearSigningKeyByAddress)(this.address),new Error("User cancel the sign process");case 10:return[2]}}))}))},e}();n.default=m},1649:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.endpoints=void 0,n.endpoints={STAGING:{ceramicUrl:"https://ceramic.stg.cybertino.io",cyberConnectSchema:"kjzl6cwe1jw149mvqedik2h3j26y4bmcvucjbbhezwcr7dgdyyg9v0x8xfvlp1j",cyberConnectApi:"https://api.stg.cybertino.io/connect/"},PRODUCTION:{ceramicUrl:"https://ceramic.cybertino.io",cyberConnectSchema:"kjzl6cwe1jw14b3g6d22ze4jaatoikiq62qrmnbzo8hkg68ic7w0smq9ymzsxta",cyberConnectApi:"https://api.cybertino.io/connect/"}}},1650:function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function d(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,d)}h((r=r.apply(e,n||[])).next())}))},o=this&&this.__generator||function(e,body){var n,t,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,t&&(r=2&c[0]?t.return:c[0]?t.throw||((r=t.return)&&r.call(t),0):t.next)&&!(r=r.call(t,c[1])).done)return r;switch(t=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,t=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],t=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ackAllNotifications=n.ackNotifications=n.biConnect=n.setAlias=n.unfollow=n.batchFollow=n.follow=n.auth=n.registerSigningKey=n.handleQuery=n.request=n.querySchemas=n.authSchema=n.ackAllNotificationsQuerySchema=n.ackNotificationsQuerySchema=n.bidirectionalConnectQuerySchema=n.setAliasQuerySchema=n.disconnectQuerySchema=n.batchConnectQuerySchema=n.connectQuerySchema=n.registerSigningKeySchema=void 0;var c=t(599);n.registerSigningKeySchema=function(input){return{operationName:"registerKey",query:"mutation registerKey($input: RegisterKeyInput!) {\n      registerKey(input: $input) {\n        result\n      }\n    }",variables:{input:input}}};n.connectQuerySchema=function(input){return{operationName:"connect",query:"mutation connect($input: UpdateConnectionInput!) {connect(input: $input) {result}}",variables:{input:input}}};n.batchConnectQuerySchema=function(input){return{operationName:"batchConnect",query:"mutation batchConnect($input: BatchUpdateConnectionInput!) {\n      batchConnect(input: $input) {\n        result\n        alreadyFollowed\n        successFollowed\n        failToFollow\n      }\n    }",variables:{input:input}}};n.disconnectQuerySchema=function(input){return{operationName:"disconnect",query:"mutation disconnect($input: UpdateConnectionInput!) {disconnect(input: $input) {result}}",variables:{input:input}}};n.setAliasQuerySchema=function(input){return{operationName:"alias",query:"mutation alias($input: UpdateConnectionInput!) {alias(input: $input) {result}}",variables:{input:input}}};n.bidirectionalConnectQuerySchema=function(input){return{operationName:"bidirectionalConnect",query:"mutation bidirectionalConnect($input: BiConnectInput!) {\n      bidirectionalConnect(input: $input) {\n        result\n        message\n      }\n    }",variables:{input:input}}};n.ackNotificationsQuerySchema=function(input){return{operationName:"ackNotifications",query:"mutation ackNotifications($input: AckNotificationsInput!) {\n      ackNotifications(input: $input) {\n        result\n      }\n    }",variables:{input:input}}};n.ackAllNotificationsQuerySchema=function(input){return{operationName:"ackAllNotifications",query:"mutation ackAllNotifications($input: AckAllNotificationsInput!) {\n      ackAllNotifications(input: $input) {\n        result\n      }\n    }",variables:{input:input}}};n.authSchema=function(e){var address=e.address,n=e.signature,t=e.network;return{operationName:"auth",query:"mutation auth($address: String!, $signature: String!, $network: String) {\n      auth(address: $address, signature: $signature, network: $network) {\n        result\n        authToken\n      }\n    }",variables:{address:address,signature:n,network:void 0===t?c.Blockchain.ETH:t}}},n.querySchemas={connect:n.connectQuerySchema,batchConnect:n.batchConnectQuerySchema,disconnect:n.disconnectQuerySchema,biConnect:n.bidirectionalConnectQuerySchema,auth:n.authSchema,setAlias:n.setAliasQuerySchema,registerSigningKey:n.registerSigningKeySchema,ackNotifications:n.ackNotificationsQuerySchema,ackAllNotifications:n.ackAllNotificationsQuerySchema};n.request=function(e,data){return void 0===e&&(e=""),void 0===data&&(data={}),r(void 0,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,fetch(e,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(data)})];case 1:return[2,n.sent().json()]}}))}))};n.handleQuery=function(data,e){return(0,n.request)(e,data)};n.registerSigningKey=function(e){var address=e.address,t=e.message,r=e.signature,o=e.network,l=void 0===o?c.Blockchain.ETH:o,d=e.url,h=n.querySchemas.registerSigningKey({address:address,message:t,signature:r,network:l});return(0,n.handleQuery)(h,d)};n.auth=function(e){var address=e.address,t=e.signature,r=e.network,o=void 0===r?c.Blockchain.ETH:r,l=e.url,d=n.querySchemas.auth({address:address,signature:t,network:o});return(0,n.handleQuery)(d,l)};n.follow=function(input,e){var t=n.querySchemas.connect(input);return(0,n.handleQuery)(t,e)};n.batchFollow=function(input,e){var t=n.querySchemas.batchConnect(input);return(0,n.handleQuery)(t,e)};n.unfollow=function(input,e){var t=n.querySchemas.disconnect(input);return(0,n.handleQuery)(t,e)};n.setAlias=function(input,e){var t=n.querySchemas.setAlias(input);return(0,n.handleQuery)(t,e)};n.biConnect=function(input,e){var t=n.querySchemas.biConnect(input);return(0,n.handleQuery)(t,e)};n.ackNotifications=function(input,e){var t=n.querySchemas.ackNotifications(input);return(0,n.handleQuery)(t,e)};n.ackAllNotifications=function(input,e){var t=n.querySchemas.ackAllNotifications(input);return(0,n.handleQuery)(t,e)}},1651:function(e,n,t){"use strict";var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,c){function l(e){try{h(r.next(e))}catch(e){c(e)}}function d(e){try{h(r.throw(e))}catch(e){c(e)}}function h(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,d)}h((r=r.apply(e,n||[])).next())}))},o=this&&this.__generator||function(e,body){var n,t,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,t&&(r=2&c[0]?t.return:c[0]?t.throw||((r=t.return)&&r.call(t),0):t.next)&&!(r=r.call(t,c[1])).done)return r;switch(t=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,t=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(e,o)}catch(e){c=[6,e],t=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.arrayBuffer2Hex=n.signWithSigningKey=n.getPublicKey=n.getSigningKey=n.hasSigningKey=n.generateSigningKey=n.rotateSigningKey=n.clearSigningKeyByAddress=n.clearSigningKey=n.clear=n.set=n.get=void 0;var c=t(2388),l=null,d="signingKey_";function h(e){return r(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return l?[4,l]:[3,2];case 1:return[2,n.sent().get("store",e)];case 2:return[2]}}))}))}function f(e,n){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return l?[4,l]:[3,2];case 1:return[2,t.sent().put("store",n,e)];case 2:return[2]}}))}))}function y(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,l];case 1:return[2,e.sent().clear("store")]}}))}))}function v(address){return r(this,void 0,void 0,(function(){var e,n,t;return o(this,(function(r){switch(r.label){case 0:return e={name:"ECDSA",namedCurve:"P-256"},!1,n=["sign","verify"],[4,window.crypto.subtle.generateKey(e,false,n)];case 1:return t=r.sent(),f(d+address,t).then(),[2,t]}}))}))}function w(address){return r(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return[4,h(d+address)];case 1:return(e=n.sent())||(e=v(address)),[2,e]}}))}))}function m(e){return"0x"+Array.prototype.map.call(new Uint8Array(e),(function(e){return("00"+e.toString(16)).slice(-2)})).join("")}"undefined"!=typeof window&&void 0!==window.indexedDB&&(l=(0,c.openDB)("CyberConnect",1,{upgrade:function(e){e.createObjectStore("store")}})),n.get=h,n.set=f,n.clear=y,n.clearSigningKey=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,y()];case 1:return e.sent(),[2]}}))}))},n.clearSigningKeyByAddress=function(address){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,l];case 1:return[2,e.sent().delete("store",d+address)]}}))}))},n.rotateSigningKey=function(address){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,y()];case 1:return e.sent(),[2,v(address)]}}))}))},n.generateSigningKey=v,n.hasSigningKey=function(address){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,h(d+address)];case 1:return[2,e.sent()]}}))}))},n.getSigningKey=w,n.getPublicKey=function(address){return r(this,void 0,void 0,(function(){var e,n;return o(this,(function(t){switch(t.label){case 0:return[4,w(address)];case 1:return e=t.sent(),[4,window.crypto.subtle.exportKey("spki",e.publicKey)];case 2:return n=t.sent(),[2,window.btoa((r=n,String.fromCharCode.apply(null,new Uint8Array(r))))]}var r}))}))},n.signWithSigningKey=function(input,address){return r(this,void 0,void 0,(function(){var e,n,t,r;return o(this,(function(o){switch(o.label){case 0:return[4,w(address)];case 1:return e=o.sent(),n={name:"ECDSA",hash:{name:"SHA-256"}},t=new TextEncoder,r=t.encode(input),[4,window.crypto.subtle.sign(n,e.privateKey,r)];case 2:return[2,m(o.sent())]}}))}))},n.arrayBuffer2Hex=m},1692:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.arrayContentStartsWith=n.arrayContentEquals=void 0,n.arrayContentEquals=function(a,b){if(a.length!==b.length)return!1;for(let i=0;i<a.length;++i)if(a[i]!==b[i])return!1;return!0},n.arrayContentStartsWith=function(a,b){if(a.length<b.length)return!1;for(let i=0;i<b.length;++i)if(a[i]!==b[i])return!1;return!0}},1693:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.assertDefinedAndNotNull=n.assertDefined=n.assert=void 0,n.assert=function(e,n){if(!e)throw new Error(n||"condition is not truthy")},n.assertDefined=function(e,n){if(void 0===e)throw new Error(null!=n?n:"value is undefined")},n.assertDefinedAndNotNull=function(e,n){if(null==e)throw new Error(null!=n?n:"value is undefined or null")}},1694:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sleep=void 0,n.sleep=async function(e){return new Promise((n=>setTimeout(n,e)))}},1695:function(e,n,t){"use strict";(function(e){function t(data){return"object"==typeof data&&null!==data}Object.defineProperty(n,"__esModule",{value:!0}),n.isUint8Array=n.isNonNullObject=void 0,n.isNonNullObject=t,n.isUint8Array=function(data){return!!t(data)&&("[object Uint8Array]"===Object.prototype.toString.call(data)&&(void 0===e||void 0===e.isBuffer||!e.isBuffer(data)))}}).call(this,t(20).Buffer)},599:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BiConnectionType=n.ConnectionType=n.Env=n.Blockchain=void 0,function(e){e.ETH="ETH",e.SOLANA="SOLANA"}(n.Blockchain||(n.Blockchain={})),function(e){e.STAGING="STAGING",e.PRODUCTION="PRODUCTION"}(n.Env||(n.Env={})),function(e){e.FOLLOW="FOLLOW",e.LIKE="LIKE",e.REPORT="REPORT",e.WATCH="WATCH",e.VOTE="VOTE"}(n.ConnectionType||(n.ConnectionType={})),function(e){e.INIT="INIT",e.ACCEPT="ACCEPT",e.REJECT="REJECT",e.TERMINATE="TERMINATE",e.BLOCK="BLOCK",e.UNBLOCK="UNBLOCK"}(n.BiConnectionType||(n.BiConnectionType={}))},677:function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getAddressByProvider=n.ConnectError=n.BiConnectionType=n.ConnectionType=n.Blockchain=n.Env=void 0;var o=r(t(1648)),c=t(599);Object.defineProperty(n,"Env",{enumerable:!0,get:function(){return c.Env}}),Object.defineProperty(n,"Blockchain",{enumerable:!0,get:function(){return c.Blockchain}}),Object.defineProperty(n,"ConnectionType",{enumerable:!0,get:function(){return c.ConnectionType}}),Object.defineProperty(n,"BiConnectionType",{enumerable:!0,get:function(){return c.BiConnectionType}});var l=t(1050);Object.defineProperty(n,"ConnectError",{enumerable:!0,get:function(){return l.ConnectError}});var d=t(1052);Object.defineProperty(n,"getAddressByProvider",{enumerable:!0,get:function(){return d.getAddressByProvider}}),n.default=o.default}}]);