(window.webpackJsonp=window.webpackJsonp||[]).push([[1117],{1175:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);r.__exportStar(n(2050),t),r.__exportStar(n(2051),t)},1179:function(e,t){},1180:function(e,t,n){"use strict";n(151),n(225)},1181:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}}},1185:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PINO_CUSTOM_CONTEXT_KEY=t.PINO_LOGGER_DEFAULTS=void 0,t.PINO_LOGGER_DEFAULTS={level:"info"},t.PINO_CUSTOM_CONTEXT_KEY="custom_context"},1187:function(e,t,n){"use strict";var r=n(646);n.o(r,"IJsonRpcProvider")&&n.d(t,"IJsonRpcProvider",(function(){return r.IJsonRpcProvider})),n.o(r,"formatJsonRpcError")&&n.d(t,"formatJsonRpcError",(function(){return r.formatJsonRpcError})),n.o(r,"formatJsonRpcRequest")&&n.d(t,"formatJsonRpcRequest",(function(){return r.formatJsonRpcRequest})),n.o(r,"formatJsonRpcResult")&&n.d(t,"formatJsonRpcResult",(function(){return r.formatJsonRpcResult})),n.o(r,"getBigIntRpcId")&&n.d(t,"getBigIntRpcId",(function(){return r.getBigIntRpcId})),n.o(r,"isHttpUrl")&&n.d(t,"isHttpUrl",(function(){return r.isHttpUrl})),n.o(r,"isJsonRpcError")&&n.d(t,"isJsonRpcError",(function(){return r.isJsonRpcError})),n.o(r,"isJsonRpcRequest")&&n.d(t,"isJsonRpcRequest",(function(){return r.isJsonRpcRequest})),n.o(r,"isJsonRpcResponse")&&n.d(t,"isJsonRpcResponse",(function(){return r.isJsonRpcResponse})),n.o(r,"isJsonRpcResult")&&n.d(t,"isJsonRpcResult",(function(){return r.isJsonRpcResult})),n.o(r,"isLocalhostUrl")&&n.d(t,"isLocalhostUrl",(function(){return r.isLocalhostUrl})),n.o(r,"isReactNative")&&n.d(t,"isReactNative",(function(){return r.isReactNative})),n.o(r,"isWsUrl")&&n.d(t,"isWsUrl",(function(){return r.isWsUrl}));r.isNode},1188:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return h}));var r=n(365),o=n(148);function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=Date.now()*Math.pow(10,e),n=Math.floor(Math.random()*Math.pow(10,e));return t+n}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return BigInt(c(e))}function f(e,t,n){return{id:n||c(),jsonrpc:"2.0",method:e,params:t}}function d(e,t){return{id:e,jsonrpc:"2.0",result:t}}function h(e,t,data){return{id:e,jsonrpc:"2.0",error:v(t,data)}}function v(e,data){return void 0===e?Object(r.a)(o.b):("string"==typeof e&&(e=Object.assign(Object.assign({},Object(r.a)(o.d)),{message:e})),void 0!==data&&(e.data=data),Object(r.c)(e.code)&&(e=Object(r.b)(e.code)),e)}},1189:function(e,t,n){"use strict";n(71),n(91),n(43),n(36),n(16),n(144)},1190:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l}));n(43),n(165),n(375),n(85);function r(e,t){var n=function(e){var t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==n&&new RegExp(t).test(n)}function o(e){return r(e,"^https?:")}function c(e){return r(e,"^wss?:")}function l(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}},1191:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return d}));var r=n(8);function o(e){return"object"===Object(r.a)(e)&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function c(e){return o(e)&&"method"in e}function l(e){return o(e)&&(f(e)||d(e))}function f(e){return"result"in e}function d(e){return"error"in e}},1193:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(3).__exportStar(n(2092),t)},1194:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(3).__exportStar(n(2093),t)},1195:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return v}));var r=n(1),o=(n(66),n(691)),c=n(252),l=n(47),f=n(76),d=n(312);function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(c.randomBytes)(f.j);return o.generateKeyPairFromSeed(e)}function v(e,t,n,r){return m.apply(this,arguments)}function m(){return m=Object(r.a)(regeneratorRuntime.mark((function e(sub,t,n,r){var c,header,h,v,data,m,y=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=y.length>4&&void 0!==y[4]?y[4]:Object(l.fromMiliseconds)(Date.now()),header={alg:f.h,typ:f.i},h=Object(d.d)(r.publicKey),v={iss:h,sub:sub,aud:t,iat:c,exp:c+n},data=Object(d.c)({header:header,payload:v}),m=o.sign(r.secretKey,data),e.abrupt("return",Object(d.e)({header:header,payload:v,signature:m}));case 8:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}},1196:function(e,t){},1278:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(12),o=n(11),c=Object(r.a)((function e(){Object(o.a)(this,e)})),l=(n(16),n(58),n(19)),f=n(24),d=n(17);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var o=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var v=function(e){Object(l.a)(n,e);var t=h(n);function n(e){return Object(o.a)(this,n),t.call(this)}return Object(r.a)(n)}(function(e){Object(l.a)(n,e);var t=h(n);function n(){return Object(o.a)(this,n),t.call(this)}return Object(r.a)(n)}(c))},1298:function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));n(87),n(107),n(43),n(111),n(116);var r=n(35),o=n(1),c=n(11),l=n(12),f=n(52),d=n(15),h=(n(66),n(51),n(42),n(80),n(16),n(85),n(36),n(71),n(546),n(73),n(547),n(548),n(549),n(550),n(551),n(552),n(553),n(554),n(555),n(556),n(557),n(558),n(559),n(560),n(561),n(562),n(77),n(48),n(46),n(156),n(86),n(37),n(83)),v=n(5),m=n(1303);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var R="".concat("wc","@2:").concat("ethereum_provider",":"),p=["eth_sendTransaction","personal_sign"],u=["chainChanged","accountsChanged"],w=Object.defineProperty,E=Object.defineProperties,x=Object.getOwnPropertyDescriptors,j=Object.getOwnPropertySymbols,_=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,I=function(a,e,s){return e in a?w(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s},k=function(a,e){for(var s in e||(e={}))_.call(e,s)&&I(a,s,e[s]);if(j){var t,n=y(j(e));try{for(n.s();!(t=n.n()).done;){s=t.value;S.call(e,s)&&I(a,s,e[s])}}catch(e){n.e(e)}finally{n.f()}}return a},N=function(a,e){return E(a,x(e))};function P(a){return Number(a[0].split(":")[1])}function T(a){return"0x".concat(a.toString(16))}function A(a){var e=a.chains,s=a.optionalChains,i=a.methods,t=a.optionalMethods,n=a.events,r=a.optionalEvents,o=a.rpcMap;if(!Object(v.M)(e))throw new Error("Invalid chains");var c=e,l=i||p,h=n||u,m={chains:c,methods:l,events:h,rpcMap:Object(d.a)({},P(c),o[P(c)])},y=null==n?void 0:n.filter((function(g){return!u.includes(g)})),O=null==i?void 0:i.filter((function(g){return!p.includes(g)}));if(!(s||r||t||null!=y&&y.length||null!=O&&O.length))return{required:m};var b=(null==y?void 0:y.length)&&(null==O?void 0:O.length)||!s;return{required:m,optional:{chains:Object(f.a)(new Set(b?c.concat(s||[]):s)),methods:Object(f.a)(new Set(l.concat(t||[]))),events:Object(f.a)(new Set(h.concat(r||[]))),rpcMap:o}}}var C=function(){function e(){var t=this;Object(c.a)(this,e),this.events=new h.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=R,this.on=function(e,s){return t.events.on(e,s),t},this.once=function(e,s){return t.events.once(e,s),t},this.removeListener=function(e,s){return t.events.removeListener(e,s),t},this.off=function(e,s){return t.events.off(e,s),t},this.parseAccount=function(e){return t.isCompatibleChainId(e)?t.parseAccountId(e).address:e},this.signer={},this.rpc={}}var t,f,y,O,w,E,x;return Object(l.a)(e,[{key:"request",value:(x=Object(o.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signer.request(t,this.formatChainId(this.chainId));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"sendAsync",value:function(e,s){this.signer.sendAsync(e,s,this.formatChainId(this.chainId))}},{key:"connected",get:function(){return!!this.signer.client&&this.signer.client.core.relayer.connected}},{key:"connecting",get:function(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}},{key:"enable",value:(E=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.session,e.t0){e.next=4;break}return e.next=4,this.connect();case 4:return e.next=6,this.request({method:"eth_requestAccounts"});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"connect",value:(w=Object(o.a)(regeneratorRuntime.mark((function e(t){var n,s,i,r,c,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.signer.client){e.next=2;break}throw new Error("Provider not initialized. Call init() first");case 2:return this.loadConnectOpts(t),n=A(this.rpc),s=n.required,i=n.optional,e.prev=4,e.next=7,new Promise(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.rpc.showQrModal&&(null==(o=l.modal)||o.subscribeModal((function(e){!e.open&&!l.signer.session&&(l.signer.abortPairingAttempt(),r(new Error("Connection request reset. Please try again.")))}))),e.next=3,l.signer.connect(N(k({namespaces:Object(d.a)({},l.namespace,s)},i&&{optionalNamespaces:Object(d.a)({},l.namespace,i)}),{pairingTopic:null==t?void 0:t.pairingTopic})).then((function(e){n(e)})).catch((function(e){r(new Error(e.message))}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 7:if(r=e.sent){e.next=10;break}return e.abrupt("return");case 10:this.setChainIds(this.rpc.chains),c=Object(v.r)(r.namespaces,[this.namespace]),this.setAccounts(c),this.events.emit("connect",{chainId:T(this.chainId)}),e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(4),this.signer.logger.error(e.t0),e.t0;case 18:return e.prev=18,this.modal&&this.modal.closeModal(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[4,15,18,21]])}))),function(e){return w.apply(this,arguments)})},{key:"disconnect",value:(O=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.session,!e.t0){e.next=4;break}return e.next=4,this.signer.disconnect();case 4:this.reset();case 5:case"end":return e.stop()}}),e,this)}))),function(){return O.apply(this,arguments)})},{key:"isWalletConnect",get:function(){return!0}},{key:"session",get:function(){return this.signer.session}},{key:"registerEventListeners",value:function(){var e=this;this.signer.on("session_event",(function(t){var i=t.params.event;"accountsChanged"===i.name?(e.accounts=e.parseAccounts(i.data),e.events.emit("accountsChanged",e.accounts)):"chainChanged"===i.name?e.setChainId(e.formatChainId(i.data)):e.events.emit(i.name,i.data),e.events.emit("session_event",t)})),this.signer.on("chainChanged",(function(t){var s=parseInt(t);e.chainId=s,e.events.emit("chainChanged",T(e.chainId)),e.persist()})),this.signer.on("session_update",(function(t){e.events.emit("session_update",t)})),this.signer.on("session_delete",(function(t){e.reset(),e.events.emit("session_delete",t),e.events.emit("disconnect",N(k({},Object(v.x)("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))})),this.signer.on("display_uri",(function(t){var s,i;e.rpc.showQrModal&&(null==(s=e.modal)||s.closeModal(),null==(i=e.modal)||i.openModal({uri:t})),e.events.emit("display_uri",t)}))}},{key:"setHttpProvider",value:function(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}},{key:"isCompatibleChainId",value:function(e){return"string"==typeof e&&e.startsWith("".concat(this.namespace,":"))}},{key:"formatChainId",value:function(e){return"".concat(this.namespace,":").concat(e)}},{key:"parseChainId",value:function(e){return Number(e.split(":")[1])}},{key:"setChainIds",value:function(e){var t=this,s=e.filter((function(i){return t.isCompatibleChainId(i)})).map((function(i){return t.parseChainId(i)}));s.length&&(this.chainId=s[0],this.events.emit("chainChanged",T(this.chainId)),this.persist())}},{key:"setChainId",value:function(e){if(this.isCompatibleChainId(e)){var s=this.parseChainId(e);this.chainId=s,this.setHttpProvider(s)}}},{key:"parseAccountId",value:function(e){var t=e.split(":"),n=Object(r.a)(t,3),s=n[0],i=n[1],o=n[2];return{chainId:"".concat(s,":").concat(i),address:o}}},{key:"setAccounts",value:function(e){var t=this;this.accounts=e.filter((function(s){return t.parseChainId(t.parseAccountId(s).chainId)===t.chainId})).map((function(s){return t.parseAccountId(s).address})),this.events.emit("accountsChanged",this.accounts)}},{key:"getRpcConfig",value:function(e){var s,i,t=this;return{chains:(null==(s=e.chains)?void 0:s.map((function(e){return t.formatChainId(e)})))||["".concat(this.namespace,":1")],optionalChains:e.optionalChains?e.optionalChains.map((function(e){return t.formatChainId(e)})):void 0,methods:(null==e?void 0:e.methods)||p,events:(null==e?void 0:e.events)||u,optionalMethods:(null==e?void 0:e.optionalMethods)||[],optionalEvents:(null==e?void 0:e.optionalEvents)||[],rpcMap:(null==e?void 0:e.rpcMap)||this.buildRpcMap(e.chains.concat(e.optionalChains||[]),e.projectId),showQrModal:!(null==e||!e.showQrModal),qrModalOptions:null!=(i=null==e?void 0:e.qrModalOptions)?i:void 0,projectId:e.projectId,metadata:e.metadata}}},{key:"buildRpcMap",value:function(e,s){var t=this,i={};return e.forEach((function(e){i[e]=t.getRpcUrl(e,s)})),i}},{key:"initialize",value:(y=Object(o.a)(regeneratorRuntime.mark((function e(t){var s,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.rpc=this.getRpcConfig(t),this.chainId=P(this.rpc.chains),e.next=4,m.a.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing});case 4:return this.signer=e.sent,this.registerEventListeners(),e.next=8,this.loadPersistedSession();case 8:if(!this.rpc.showQrModal){e.next=28;break}return e.prev=9,e.next=12,n.e(1242).then(n.bind(null,2395));case 12:r=e.sent,i=r.WalletConnectModal,s=i,e.next=20;break;case 17:throw e.prev=17,e.t0=e.catch(9),new Error("To use QR modal, please install @walletconnect/modal package");case 20:if(!s){e.next=28;break}e.prev=21,this.modal=new s(k({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions)),e.next=28;break;case 25:throw e.prev=25,e.t1=e.catch(21),this.signer.logger.error(e.t1),new Error("Could not generate WalletConnectModal Instance");case 28:case"end":return e.stop()}}),e,this,[[9,17],[21,25]])}))),function(e){return y.apply(this,arguments)})},{key:"loadConnectOpts",value:function(e){var t=this;if(e){var s=e.chains,i=e.optionalChains,n=e.rpcMap;s&&Object(v.M)(s)&&(this.rpc.chains=s.map((function(e){return t.formatChainId(e)})),s.forEach((function(e){t.rpc.rpcMap[e]=(null==n?void 0:n[e])||t.getRpcUrl(e)}))),i&&Object(v.M)(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=null==i?void 0:i.map((function(e){return t.formatChainId(e)})),i.forEach((function(e){t.rpc.rpcMap[e]=(null==n?void 0:n[e])||t.getRpcUrl(e)})))}}},{key:"getRpcUrl",value:function(e,s){var i;return(null==(i=this.rpc.rpcMap)?void 0:i[e])||"".concat("https://rpc.walletconnect.com/v1/","?chainId=eip155:").concat(e,"&projectId=").concat(s||this.rpc.projectId)}},{key:"loadPersistedSession",value:(f=Object(o.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.session){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.signer.client.core.storage.getItem("".concat(this.STORAGE_KEY,"/chainId"));case 4:t=e.sent,this.setChainIds(t?[this.formatChainId(t)]:this.session.namespaces[this.namespace].accounts),this.setAccounts(this.session.namespaces[this.namespace].accounts);case 6:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"reset",value:function(){this.chainId=1,this.accounts=[]}},{key:"persist",value:function(){this.session&&this.signer.client.core.storage.setItem("".concat(this.STORAGE_KEY,"/chainId"),this.chainId)}},{key:"parseAccounts",value:function(e){var t=this;return"string"==typeof e||e instanceof String?[this.parseAccount(e)]:e.map((function(s){return t.parseAccount(s)}))}}],[{key:"init",value:(t=Object(o.a)(regeneratorRuntime.mark((function t(n){var s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=new e,t.next=3,s.initialize(n);case 3:return t.abrupt("return",s);case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]),e}(),M=C},1301:function(e,t,n){"use strict";var r=n(1179);n.o(r,"RELAY_JSONRPC")&&n.d(t,"RELAY_JSONRPC",(function(){return r.RELAY_JSONRPC}));n(1180);var o=n(1181);n.d(t,"RELAY_JSONRPC",(function(){return o.a}));n(225)},1304:function(e,t,n){"use strict";var r=n(216),o=n(215);n(66),n(39),n(86),n(337),Object.defineProperty(t,"__esModule",{value:!0}),t.KeyValueStorage=void 0;var c=n(3),l=n(1192),f=c.__importDefault(n(2085)),d=n(2088),h=function(){function e(){r(this,e),this.localStorage=f.default}return o(e,[{key:"getKeys",value:function(){return c.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object.keys(this.localStorage));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"getEntries",value:function(){return c.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object.entries(this.localStorage).map(d.parseEntry));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"getItem",value:function(e){return c.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(n=this.localStorage.getItem(e))){t.next=3;break}return t.abrupt("return",void 0);case 3:return t.abrupt("return",l.safeJsonParse(n));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"setItem",value:function(e,t){return c.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.localStorage.setItem(e,l.safeJsonStringify(t));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"removeItem",value:function(e){return c.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.localStorage.removeItem(e);case 1:case"end":return t.stop()}}),t,this)})))}}]),e}();t.KeyValueStorage=h,t.default=h},1305:function(e,t,n){"use strict";var r=n(647);t.a=r.a},148:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return h})),n.d(t,"a",(function(){return v}));var r,o=n(15),c="INTERNAL_ERROR",l="SERVER_ERROR",f=[-32700,-32600,-32601,-32602,-32603],d=[-32e3,-32099],h=(r={},Object(o.a)(r,"PARSE_ERROR",{code:-32700,message:"Parse error"}),Object(o.a)(r,"INVALID_REQUEST",{code:-32600,message:"Invalid Request"}),Object(o.a)(r,"METHOD_NOT_FOUND",{code:-32601,message:"Method not found"}),Object(o.a)(r,"INVALID_PARAMS",{code:-32602,message:"Invalid params"}),Object(o.a)(r,c,{code:-32603,message:"Internal error"}),Object(o.a)(r,l,{code:-32e3,message:"Server error"}),r),v=l},151:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l}));var r=n(8);n(16),n(37),n(39),n(43),n(196),n(144);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"string";if(!e[t]||Object(r.a)(e[t])!==n)throw new Error('Missing or invalid "'.concat(t,'" param'))}function c(e,t,n){var r=!n.length?function(e,t){return Array.isArray(e)?e.length===t:Object.keys(e).length===t}(e,t.length):function(e,t){return Array.isArray(e)?e.length>=t:Object.keys(e).length>=t}(e,t.length);return!!r&&function(e,t){var n=!0;return t.forEach((function(t){t in e||(n=!1)})),n}(e,t)}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_",r=e.split(n);return r[r.length-1].trim().toLowerCase()===t.trim().toLowerCase()}},192:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(8);n(16),n(85),n(43),n(99),n(165);function o(e){if("string"!=typeof e)throw new Error("Cannot safe json parse value of type ".concat(Object(r.a)(e)));try{return t=e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3'),JSON.parse(t,(function(e,t){return"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t}))}catch(t){return e}var t}function c(e){return"string"==typeof e?e:(data=e,JSON.stringify(data,(function(e,t){return"bigint"==typeof t?t.toString()+"n":t}))||"");var data}},194:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return x})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return R})),n.d(t,"k",(function(){return E}));n(58);var r=n(12),o=n(11),c=n(19),l=n(24),f=n(17),d=(n(322),n(16),n(73),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(77),n(46),n(86),n(316)),h=n(83),v=n.n(h);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var o=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var y=function(e){Object(c.a)(n,e);var t=m(n);function n(s){var e;return Object(o.a)(this,n),(e=t.call(this)).opts=s,e.protocol="wc",e.version=2,e}return Object(r.a)(n)}(d.IEvents),O=function(e){Object(c.a)(n,e);var t=m(n);function n(s,e){var r;return Object(o.a)(this,n),(r=t.call(this)).core=s,r.logger=e,r.records=new Map,r}return Object(r.a)(n)}(d.IEvents),a=Object(r.a)((function a(s,e){Object(o.a)(this,a),this.logger=s,this.core=e})),u=function(e){Object(c.a)(u,e);var t=m(u);function u(s,e){var n;return Object(o.a)(this,u),(n=t.call(this)).relayer=s,n.logger=e,n}return Object(r.a)(u)}(d.IEvents),g=function(e){Object(c.a)(g,e);var t=m(g);function g(s){return Object(o.a)(this,g),t.call(this)}return Object(r.a)(g)}(d.IEvents),p=Object(r.a)((function p(s,e,t,n){Object(o.a)(this,p),this.core=s,this.logger=e,this.name=t})),R=function(e){Object(c.a)(n,e);var t=m(n);function n(s,e){var r;return Object(o.a)(this,n),(r=t.call(this)).relayer=s,r.logger=e,r}return Object(r.a)(n)}(d.IEvents),w=function(e){Object(c.a)(n,e);var t=m(n);function n(s,e){var r;return Object(o.a)(this,n),(r=t.call(this)).core=s,r.logger=e,r}return Object(r.a)(n)}(d.IEvents),E=Object(r.a)((function e(s,t){Object(o.a)(this,e),this.projectId=s,this.logger=t})),b=(v.a,Object(r.a)((function b(s){Object(o.a)(this,b),this.opts=s,this.protocol="wc",this.version=2}))),x=(h.EventEmitter,Object(r.a)((function e(s){Object(o.a)(this,e),this.client=s})))},2047:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);r.__exportStar(n(2048),t),r.__exportStar(n(2049),t)},2048:function(e,t,n){"use strict";n(16),n(114),Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise((function(t){setTimeout((function(){t(!0)}),e)}))}},2049:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromMiliseconds=t.toMiliseconds=void 0;var r=n(1175);t.toMiliseconds=function(e){return e*r.ONE_THOUSAND},t.fromMiliseconds=function(e){return Math.floor(e/r.ONE_THOUSAND)}},2050:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_THOUSAND=t.ONE_HUNDRED=void 0,t.ONE_HUNDRED=100,t.ONE_THOUSAND=1e3},2051:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=5*t.ONE_MINUTE,t.TEN_MINUTES=10*t.ONE_MINUTE,t.THIRTY_MINUTES=30*t.ONE_MINUTE,t.SIXTY_MINUTES=60*t.ONE_MINUTE,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=3*t.ONE_HOUR,t.SIX_HOURS=6*t.ONE_HOUR,t.TWELVE_HOURS=12*t.ONE_HOUR,t.TWENTY_FOUR_HOURS=24*t.ONE_HOUR,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=3*t.ONE_DAY,t.FIVE_DAYS=5*t.ONE_DAY,t.SEVEN_DAYS=7*t.ONE_DAY,t.THIRTY_DAYS=30*t.ONE_DAY,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=2*t.ONE_WEEK,t.THREE_WEEKS=3*t.ONE_WEEK,t.FOUR_WEEKS=4*t.ONE_WEEK,t.ONE_YEAR=365*t.ONE_DAY},2052:function(e,t,n){"use strict";var r=n(216),o=n(215);n(322),n(16),n(73),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(77),Object.defineProperty(t,"__esModule",{value:!0}),t.Watch=void 0;var c=function(){function e(){r(this,e),this.timestamps=new Map}return o(e,[{key:"start",value:function(label){if(this.timestamps.has(label))throw new Error("Watch already started for label: ".concat(label));this.timestamps.set(label,{started:Date.now()})}},{key:"stop",value:function(label){var e=this.get(label);if(void 0!==e.elapsed)throw new Error("Watch already stopped for label: ".concat(label));var t=Date.now()-e.started;this.timestamps.set(label,{started:e.started,elapsed:t})}},{key:"get",value:function(label){var e=this.timestamps.get(label);if(void 0===e)throw new Error("No timestamp found for label: ".concat(label));return e}},{key:"elapsed",value:function(label){var e=this.get(label),t=e.elapsed||Date.now()-e.started;return t}}]),e}();t.Watch=c,t.default=c},2053:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(3).__exportStar(n(2054),t)},2054:function(e,t,n){"use strict";var r=n(215),o=n(216);Object.defineProperty(t,"__esModule",{value:!0}),t.IWatch=void 0;var c=r((function e(){o(this,e)}));t.IWatch=c},2078:function(e,t,n){"use strict";n(144),n(48),Object.defineProperty(t,"__esModule",{value:!0}),t.generateChildLogger=t.formatChildLoggerContext=t.getLoggerContext=t.setBrowserLoggerContext=t.getBrowserLoggerContext=t.getDefaultLoggerOptions=void 0;var r=n(1185);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.PINO_CUSTOM_CONTEXT_KEY;return e[t]||""}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.PINO_CUSTOM_CONTEXT_KEY;return e[n]=t,e}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.PINO_CUSTOM_CONTEXT_KEY;return void 0===e.bindings?o(e,t):e.bindings().context||""}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.PINO_CUSTOM_CONTEXT_KEY,o=l(e,n),c=o.trim()?"".concat(o,"/").concat(t):t;return c}t.getDefaultLoggerOptions=function(e){return Object.assign(Object.assign({},e),{level:(null==e?void 0:e.level)||r.PINO_LOGGER_DEFAULTS.level})},t.getBrowserLoggerContext=o,t.setBrowserLoggerContext=c,t.getLoggerContext=l,t.formatChildLoggerContext=f,t.generateChildLogger=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.PINO_CUSTOM_CONTEXT_KEY,o=f(e,t,n),l=e.child({context:o});return c(l,o,n)}},2082:function(e,t,n){"use strict";(function(e){function n(){return(null==e?void 0:e.crypto)||(null==e?void 0:e.msCrypto)||{}}function r(){var e=n();return e.subtle||e.webkitSubtle}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserCryptoAvailable=t.getSubtleCrypto=t.getBrowerCrypto=void 0,t.getBrowerCrypto=n,t.getSubtleCrypto=r,t.isBrowserCryptoAvailable=function(){return!!n()&&!!r()}}).call(this,n(31))},2083:function(e,t,n){"use strict";(function(e){function n(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function r(){return void 0!==e&&void 0!==e.versions&&void 0!==e.versions.node}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=t.isReactNative=void 0,t.isReactNative=n,t.isNode=r,t.isBrowser=function(){return!n()&&!r()}}).call(this,n(74))},2085:function(e,t,n){"use strict";(function(t){n(16),n(37),n(39),n(2086),function(){var n;function r(){}(n=r).prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},n.prototype.setItem=function(e,t){this[e]=String(t)},n.prototype.removeItem=function(e){delete this[e]},n.prototype.clear=function(){var e=this;Object.keys(e).forEach((function(t){e[t]=void 0,delete e[t]}))},n.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},n.prototype.__defineGetter__("length",(function(){return Object.keys(this).length})),void 0!==t&&t.localStorage?e.exports=t.localStorage:"undefined"!=typeof window&&window.localStorage?e.exports=window.localStorage:e.exports=new r}()}).call(this,n(31))},2088:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);r.__exportStar(n(2089),t),r.__exportStar(n(2090),t)},2089:function(e,t,n){"use strict";var r=n(215),o=n(216);Object.defineProperty(t,"__esModule",{value:!0}),t.IKeyValueStorage=void 0;var c=r((function e(){o(this,e)}));t.IKeyValueStorage=c},2090:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseEntry=void 0;var r=n(1192);t.parseEntry=function(e){var t;return[e[0],r.safeJsonParse(null!==(t=e[1])&&void 0!==t?t:"")]}},2091:function(e,t,n){"use strict";n(16),n(58);var r=n(216),o=n(215),c=n(473),l=n(474),f=n(475);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l(this,n)}}n(114),n(66),Object.defineProperty(t,"__esModule",{value:!0}),t.HeartBeat=void 0;var h=n(3),v=n(83),m=n(47),y=n(1193),O=n(1194),R=function(e){c(n,e);var t=d(n);function n(e){var o;return r(this,n),(o=t.call(this,e)).events=new v.EventEmitter,o.interval=O.HEARTBEAT_INTERVAL,o.interval=(null==e?void 0:e.interval)||O.HEARTBEAT_INTERVAL,o}return o(n,[{key:"init",value:function(){return h.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initialize();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"stop",value:function(){clearInterval(this.intervalRef)}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"initialize",value:function(){return h.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.intervalRef=setInterval((function(){return t.pulse()}),m.toMiliseconds(this.interval));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"pulse",value:function(){this.events.emit(O.HEARTBEAT_EVENTS.pulse)}}],[{key:"init",value:function(e){return h.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new n(e),t.next=3,r.init();case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))}}]),n}(y.IHeartBeat);t.HeartBeat=R},2092:function(e,t,n){"use strict";n(16),n(58);var r=n(215),o=n(216),c=n(473),l=n(474),f=n(475);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l(this,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.IHeartBeat=void 0;var h=function(e){c(n,e);var t=d(n);function n(e){return o(this,n),t.call(this)}return r(n)}(n(316).IEvents);t.IHeartBeat=h},2093:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HEARTBEAT_EVENTS=t.HEARTBEAT_INTERVAL=void 0;var r=n(47);t.HEARTBEAT_INTERVAL=r.FIVE_SECONDS,t.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"}},225:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return h})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return m}));var r=n(151);function o(e){return Object(r.c)(e,"subscribe")}function c(e){return Object(r.b)(e,["topic"],[])}function l(e){return Object(r.c)(e,"publish")}function f(e){return Object(r.b)(e,["message","topic","ttl"],["prompt","tag"])}function d(e){return Object(r.c)(e,"unsubscribe")}function h(e){return Object(r.b)(e,["id","topic"],[])}function v(e){return Object(r.c)(e,"subscription")}function m(e){return Object(r.b)(e,["id","data"],[])}},259:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));n(58);var r=n(1),o=n(11),c=n(12),l=n(19),f=n(24),d=n(17),h=(n(16),n(85),n(48),n(66),n(83)),v=n(57);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var o=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var y=function(e){Object(l.a)(w,e);var t,n,f,d,y,O,R=m(w);function w(e){var t;return Object(o.a)(this,w),(t=R.call(this,e)).events=new h.EventEmitter,t.hasRegisteredEventListeners=!1,t.connection=t.setConnection(e),t.connection.connected&&t.registerEventListeners(),t}return Object(c.a)(w,[{key:"connect",value:(O=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:this.connection,e.next=3,this.open(t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return O.apply(this,arguments)})},{key:"disconnect",value:(y=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.close();case 2:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"request",value:(d=Object(r.a)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.requestStrict(Object(v.formatJsonRpcRequest)(t.method,t.params||[],t.id||Object(v.getBigIntRpcId)().toString()),n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"requestStrict",value:(f=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(r,c){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.connection.connected){e.next=9;break}return e.prev=1,e.next=4,o.open();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),c(e.t0);case 9:return o.events.on("".concat(t.id),(function(e){Object(v.isJsonRpcError)(e)?c(e.error):r(e.result)})),e.prev=10,e.next=13,o.connection.send(t,n);case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(10),c(e.t1);case 18:case"end":return e.stop()}}),e,null,[[1,6],[10,15]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return f.apply(this,arguments)})},{key:"setConnection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.connection;return e}},{key:"onPayload",value:function(e){this.events.emit("payload",e),Object(v.isJsonRpcResponse)(e)?this.events.emit("".concat(e.id),e):this.events.emit("message",{type:e.method,data:e.params})}},{key:"onClose",value:function(e){e&&3e3===e.code&&this.events.emit("error",new Error("WebSocket connection closed abnormally with code: ".concat(e.code," ").concat(e.reason?"(".concat(e.reason,")"):""))),this.events.emit("disconnect")}},{key:"open",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:this.connection,this.connection!==t||!this.connection.connected){e.next=3;break}return e.abrupt("return");case 3:if(this.connection.connected&&this.close(),"string"!=typeof t){e.next=8;break}return e.next=7,this.connection.open(t);case 7:t=this.connection;case 8:return this.connection=this.setConnection(t),e.next=11,this.connection.open();case 11:this.registerEventListeners(),this.events.emit("connect");case 13:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"close",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connection.close();case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"registerEventListeners",value:function(){var e=this;this.hasRegisteredEventListeners||(this.connection.on("payload",(function(t){return e.onPayload(t)})),this.connection.on("close",(function(t){return e.onClose(t)})),this.connection.on("error",(function(t){return e.events.emit("error",t)})),this.connection.on("register_error",(function(t){return e.onClose()})),this.hasRegisteredEventListeners=!0)}}]),w}(v.IJsonRpcProvider)},312:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return O})),n.d(t,"e",(function(){return R})),n.d(t,"b",(function(){return w}));var r=n(35),o=(n(129),n(43),n(196),n(87),n(861)),c=n(315),l=n(285),f=n(192),d=n(76);function h(e){return Object(f.a)(Object(c.toString)(Object(l.fromString)(e,d.g),d.e))}function v(e){return Object(c.toString)(Object(l.fromString)(Object(f.b)(e),d.e),d.g)}function m(e){var header=Object(l.fromString)(d.m,d.l),t=d.k+Object(c.toString)(Object(o.concat)([header,e]),d.l);return[d.d,d.c,t].join(d.b)}function y(e){var t=e.split(d.b),n=Object(r.a)(t,3),o=n[0],f=n[1],h=n[2];if(o!==d.d||f!==d.c)throw new Error('Issuer must be a DID with method "key"');if(h.slice(0,1)!==d.k)throw new Error("Issuer must be a key in mulicodec format");var v=Object(l.fromString)(h.slice(1),d.l);if(Object(c.toString)(v.slice(0,2),d.l)!==d.m)throw new Error('Issuer must be a public key with type "Ed25519"');var m=v.slice(2);if(m.length!==d.n)throw new Error("Issuer must be a public key with length 32 bytes");return m}function O(e){return Object(l.fromString)([v(e.header),v(e.payload)].join(d.f),d.a)}function R(e){return[v(e.header),v(e.payload),(t=e.signature,Object(c.toString)(t,d.g))].join(d.f);var t}function w(e){var t,n=e.split(d.f);return{header:h(n[0]),payload:h(n[1]),signature:(t=n[2],Object(l.fromString)(t,d.g)),data:Object(l.fromString)(n.slice(0,2).join(d.f),d.a)}}},316:function(e,t,n){"use strict";n.r(t),n.d(t,"IEvents",(function(){return c}));var r=n(12),o=n(11),c=Object(r.a)((function e(){Object(o.a)(this,e)}))},318:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(1),o=n(11),c=n(12),l=(n(16),n(85),n(66),n(83)),f=n(877),d=n.n(f),h=n(192),v=n(57),m={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},y=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object(o.a)(this,e),this.url=t,this.disableProviderPing=n,this.events=new l.EventEmitter,this.isAvailable=!1,this.registering=!1,!Object(v.isHttpUrl)(t))throw new Error("Provided URL is not compatible with HTTP connection: ".concat(t));this.url=t,this.disableProviderPing=n}var t,n,f,y;return Object(c.a)(e,[{key:"connected",get:function(){return this.isAvailable}},{key:"connecting",get:function(){return this.registering}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"open",value:(y=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:this.url,e.next=3,this.register(t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"close",value:(f=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isAvailable){e.next=2;break}throw new Error("Connection already closed");case 2:this.onClose();case 3:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"send",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var body,r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isAvailable){e.next=3;break}return e.next=3,this.register();case 3:return e.prev=3,body=Object(h.b)(t),e.next=7,d()(this.url,Object.assign(Object.assign({},m),{body:body}));case 7:return r=e.sent,e.next=10,r.json();case 10:data=e.sent,this.onPayload({data:data}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),this.onError(t.id,e.t0);case 17:case"end":return e.stop()}}),e,this,[[3,14]])}))),function(e,t){return n.apply(this,arguments)})},{key:"register",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,body,r,o=this,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:this.url,Object(v.isHttpUrl)(t)){e.next=3;break}throw new Error("Provided URL is not compatible with HTTP connection: ".concat(t));case 3:if(!this.registering){e.next=7;break}return n=this.events.getMaxListeners(),(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),e.abrupt("return",new Promise((function(e,t){o.events.once("register_error",(function(e){o.resetMaxListeners(),t(e)})),o.events.once("open",(function(){if(o.resetMaxListeners(),void 0===o.isAvailable)return t(new Error("HTTP connection is missing or invalid"));e()}))})));case 7:if(this.url=t,this.registering=!0,e.prev=9,this.disableProviderPing){e.next=14;break}return body=Object(h.b)({id:1,jsonrpc:"2.0",method:"test",params:[]}),e.next=14,d()(t,Object.assign(Object.assign({},m),{body:body}));case 14:this.onOpen(),e.next=23;break;case 17:throw e.prev=17,e.t0=e.catch(9),r=this.parseError(e.t0),this.events.emit("register_error",r),this.onClose(),r;case 23:case"end":return e.stop()}}),e,this,[[9,17]])}))),function(){return t.apply(this,arguments)})},{key:"onOpen",value:function(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}},{key:"onClose",value:function(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}},{key:"onPayload",value:function(e){if(void 0!==e.data){var t="string"==typeof e.data?Object(h.a)(e.data):e.data;this.events.emit("payload",t)}}},{key:"onError",value:function(e,t){var n=this.parseError(t),r=n.message||n.toString(),o=Object(v.formatJsonRpcError)(e,r);this.events.emit("payload",o)}},{key:"parseError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.url;return Object(v.parseConnectionError)(e,t,"HTTP")}},{key:"resetMaxListeners",value:function(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}]),e}(),O=y;t.b=O},365:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return f}));n(71),n(91),n(39),n(117),n(16),n(264),n(48);var r=n(148);function o(code){return r.c.includes(code)}function c(e){return Object.keys(r.f).includes(e)?r.f[e]:r.f[r.a]}function l(code){var e=Object.values(r.f).find((function(e){return e.code===code}));return e||r.f[r.a]}function f(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error("Unavailable ".concat(n," RPC url at ").concat(t)):e}},47:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);r.__exportStar(n(2047),t),r.__exportStar(n(2052),t),r.__exportStar(n(2053),t),r.__exportStar(n(1175),t)},509:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);r.__exportStar(n(2091),t),r.__exportStar(n(1193),t),r.__exportStar(n(1194),t)},510:function(e,t,n){"use strict";var r=n(1195);n.d(t,"generateKeyPair",(function(){return r.a})),n.d(t,"signJWT",(function(){return r.b}));n(76);var o=n(1196);n.o(o,"encodeIss")&&n.d(t,"encodeIss",(function(){return o.encodeIss}));var c=n(312);n.d(t,"encodeIss",(function(){return c.d}))},57:function(e,t,n){"use strict";n(148);var r=n(365);n.d(t,"parseConnectionError",(function(){return r.d}));var o=n(1187);n.o(o,"IJsonRpcProvider")&&n.d(t,"IJsonRpcProvider",(function(){return o.IJsonRpcProvider})),n.o(o,"formatJsonRpcError")&&n.d(t,"formatJsonRpcError",(function(){return o.formatJsonRpcError})),n.o(o,"formatJsonRpcRequest")&&n.d(t,"formatJsonRpcRequest",(function(){return o.formatJsonRpcRequest})),n.o(o,"formatJsonRpcResult")&&n.d(t,"formatJsonRpcResult",(function(){return o.formatJsonRpcResult})),n.o(o,"getBigIntRpcId")&&n.d(t,"getBigIntRpcId",(function(){return o.getBigIntRpcId})),n.o(o,"isHttpUrl")&&n.d(t,"isHttpUrl",(function(){return o.isHttpUrl})),n.o(o,"isJsonRpcError")&&n.d(t,"isJsonRpcError",(function(){return o.isJsonRpcError})),n.o(o,"isJsonRpcRequest")&&n.d(t,"isJsonRpcRequest",(function(){return o.isJsonRpcRequest})),n.o(o,"isJsonRpcResponse")&&n.d(t,"isJsonRpcResponse",(function(){return o.isJsonRpcResponse})),n.o(o,"isJsonRpcResult")&&n.d(t,"isJsonRpcResult",(function(){return o.isJsonRpcResult})),n.o(o,"isLocalhostUrl")&&n.d(t,"isLocalhostUrl",(function(){return o.isLocalhostUrl})),n.o(o,"isReactNative")&&n.d(t,"isReactNative",(function(){return o.isReactNative})),n.o(o,"isWsUrl")&&n.d(t,"isWsUrl",(function(){return o.isWsUrl}));var c=n(1188);n.d(t,"formatJsonRpcError",(function(){return c.a})),n.d(t,"formatJsonRpcRequest",(function(){return c.b})),n.d(t,"formatJsonRpcResult",(function(){return c.c})),n.d(t,"getBigIntRpcId",(function(){return c.d}));n(1189);var l=n(1278);n.d(t,"IJsonRpcProvider",(function(){return l.a}));var f=n(1190);n.d(t,"isHttpUrl",(function(){return f.a})),n.d(t,"isLocalhostUrl",(function(){return f.b})),n.d(t,"isWsUrl",(function(){return f.c}));var d=n(1191);n.d(t,"isJsonRpcError",(function(){return d.a})),n.d(t,"isJsonRpcRequest",(function(){return d.b})),n.d(t,"isJsonRpcResponse",(function(){return d.c})),n.d(t,"isJsonRpcResult",(function(){return d.d}))},646:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);r.__exportStar(n(2082),t),r.__exportStar(n(2083),t)},647:function(e,t,n){"use strict";(function(e){var r=n(1),o=n(11),c=n(12),l=(n(16),n(85),n(66),n(83)),f=n(192),d=n(57),h=function(){return"undefined"!=typeof window},v=void 0!==e&&void 0!==e.WebSocket?e.WebSocket:"undefined"!=typeof window&&void 0!==window.WebSocket?window.WebSocket:n(2095),m=function(){function e(t){if(Object(o.a)(this,e),this.url=t,this.events=new l.EventEmitter,this.registering=!1,!Object(d.isWsUrl)(t))throw new Error("Provided URL is not compatible with WebSocket connection: ".concat(t));this.url=t}var t,n,m;return Object(c.a)(e,[{key:"connected",get:function(){return void 0!==this.socket}},{key:"connecting",get:function(){return this.registering}},{key:"on",value:function(e,t){this.events.on(e,t)}},{key:"once",value:function(e,t){this.events.once(e,t)}},{key:"off",value:function(e,t){this.events.off(e,t)}},{key:"removeListener",value:function(e,t){this.events.removeListener(e,t)}},{key:"open",value:(m=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:this.url,e.next=3,this.register(t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"close",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){void 0!==t.socket?(t.socket.onclose=function(n){t.onClose(n),e()},t.socket.close()):n(new Error("Connection already closed"))})));case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"send",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.socket){e.next=4;break}return e.next=3,this.register();case 3:this.socket=e.sent;case 4:try{this.socket.send(Object(f.b)(t))}catch(e){this.onError(t.id,e)}case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"register",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.url;if(!Object(d.isWsUrl)(t))throw new Error("Provided URL is not compatible with WebSocket connection: ".concat(t));if(this.registering){var n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((function(t,n){e.events.once("register_error",(function(t){e.resetMaxListeners(),n(t)})),e.events.once("open",(function(){if(e.resetMaxListeners(),void 0===e.socket)return n(new Error("WebSocket connection is missing or invalid"));t(e.socket)}))}))}return this.url=t,this.registering=!0,new Promise((function(n,r){var o=Object(d.isReactNative)()?void 0:{rejectUnauthorized:!Object(d.isLocalhostUrl)(t)},c=new v(t,[],o);h()?c.onerror=function(t){var n=t;r(e.emitError(n.error))}:c.on("error",(function(t){r(e.emitError(t))})),c.onopen=function(){e.onOpen(c),n(c)}}))}},{key:"onOpen",value:function(e){var t=this;e.onmessage=function(e){return t.onPayload(e)},e.onclose=function(e){return t.onClose(e)},this.socket=e,this.registering=!1,this.events.emit("open")}},{key:"onClose",value:function(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}},{key:"onPayload",value:function(e){if(void 0!==e.data){var t="string"==typeof e.data?Object(f.a)(e.data):e.data;this.events.emit("payload",t)}}},{key:"onError",value:function(e,t){var n=this.parseError(t),r=n.message||n.toString(),o=Object(d.formatJsonRpcError)(e,r);this.events.emit("payload",o)}},{key:"parseError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.url;return Object(d.parseConnectionError)(e,t,"WS")}},{key:"resetMaxListeners",value:function(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}},{key:"emitError",value:function(e){var t=this.parseError(new Error((null==e?void 0:e.message)||"WebSocket connection failed for URL: ".concat(this.url)));return this.events.emit("register_error",t),t}}]),e}();t.a=m}).call(this,n(31))},76:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return m})),n.d(t,"l",(function(){return y})),n.d(t,"k",(function(){return O})),n.d(t,"m",(function(){return R})),n.d(t,"n",(function(){return w})),n.d(t,"j",(function(){return E}));var r="EdDSA",o="JWT",c=".",l="base64url",f="utf8",d="utf8",h=":",v="did",m="key",y="base58btc",O="z",R="K36",w=32,E=32},79:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;var r=n(3),o=r.__importDefault(n(2076));Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return o.default}}),r.__exportStar(n(1185),t),r.__exportStar(n(2078),t)},877:function(e,t,n){n(16),n(73),n(77),n(290),n(42),n(111),n(116),n(823),n(450),n(2079),n(1186),n(43),n(86),n(37),n(2081),n(515),n(516),n(517),n(518),n(519),n(520),n(521),n(522),n(523),n(524),n(525),n(526),n(527),n(528),n(529),n(530),n(531),n(532),n(533),n(534),n(535),n(536),n(537),n(538),n(129),n(87),n(85),n(144),n(99),n(196),n(46);var r="undefined"!=typeof self?self:this,o=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var n="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,o="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),c="FormData"in e,l="ArrayBuffer"in e;if(l)var f=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(e){return e&&f.indexOf(Object.prototype.toString.call(e))>-1};function h(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function v(e){return"string"!=typeof e&&(e=String(e)),e}function m(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function y(e){this.map={},e instanceof y?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(header){this.append(header[0],header[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function O(body){if(body.bodyUsed)return Promise.reject(new TypeError("Already read"));body.bodyUsed=!0}function R(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function w(e){var t=new FileReader,n=R(t);return t.readAsArrayBuffer(e),n}function E(e){if(e.slice)return e.slice(0);var view=new Uint8Array(e.byteLength);return view.set(new Uint8Array(e)),view.buffer}function x(){return this.bodyUsed=!1,this._initBody=function(body){var e;this._bodyInit=body,body?"string"==typeof body?this._bodyText=body:o&&Blob.prototype.isPrototypeOf(body)?this._bodyBlob=body:c&&FormData.prototype.isPrototypeOf(body)?this._bodyFormData=body:n&&URLSearchParams.prototype.isPrototypeOf(body)?this._bodyText=body.toString():l&&o&&((e=body)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=E(body.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l&&(ArrayBuffer.prototype.isPrototypeOf(body)||d(body))?this._bodyArrayBuffer=E(body):this._bodyText=body=Object.prototype.toString.call(body):this._bodyText="",this.headers.get("content-type")||("string"==typeof body?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(body)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=O(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?O(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(w)}),this.text=function(){var e,t,n,r=O(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=R(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var view=new Uint8Array(e),t=new Array(view.length),i=0;i<view.length;i++)t[i]=String.fromCharCode(view[i]);return t.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}y.prototype.append=function(e,t){e=h(e),t=v(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},y.prototype.delete=function(e){delete this.map[h(e)]},y.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},y.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},y.prototype.set=function(e,t){this.map[h(e)]=v(t)},y.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},y.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),m(e)},y.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),m(e)},y.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),m(e)},r&&(y.prototype[Symbol.iterator]=y.prototype.entries);var j=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function _(input,e){var t,n,body=(e=e||{}).body;if(input instanceof _){if(input.bodyUsed)throw new TypeError("Already read");this.url=input.url,this.credentials=input.credentials,e.headers||(this.headers=new y(input.headers)),this.method=input.method,this.mode=input.mode,this.signal=input.signal,body||null==input._bodyInit||(body=input._bodyInit,input.bodyUsed=!0)}else this.url=String(input);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new y(e.headers)),this.method=(t=e.method||this.method||"GET",n=t.toUpperCase(),j.indexOf(n)>-1?n:t),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(body)}function S(body){var form=new FormData;return body.trim().split("&").forEach((function(e){if(e){var t=e.split("="),n=t.shift().replace(/\+/g," "),r=t.join("=").replace(/\+/g," ");form.append(decodeURIComponent(n),decodeURIComponent(r))}})),form}function I(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new y(t.headers),this.url=t.url||"",this._initBody(e)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})},x.call(_.prototype),x.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new y(this.headers),url:this.url})},I.error=function(){var e=new I(null,{status:0,statusText:""});return e.type="error",e};var k=[301,302,303,307,308];I.redirect=function(e,t){if(-1===k.indexOf(t))throw new RangeError("Invalid status code");return new I(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function N(input,e){return new Promise((function(n,r){var c=new _(input,e);if(c.signal&&c.signal.aborted)return r(new t.DOMException("Aborted","AbortError"));var l=new XMLHttpRequest;function f(){l.abort()}l.onload=function(){var e,t,r={status:l.status,statusText:l.statusText,headers:(e=l.getAllResponseHeaders()||"",t=new y,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(line){var e=line.split(":"),n=e.shift().trim();if(n){var r=e.join(":").trim();t.append(n,r)}})),t)};r.url="responseURL"in l?l.responseURL:r.headers.get("X-Request-URL");var body="response"in l?l.response:l.responseText;n(new I(body,r))},l.onerror=function(){r(new TypeError("Network request failed"))},l.ontimeout=function(){r(new TypeError("Network request failed"))},l.onabort=function(){r(new t.DOMException("Aborted","AbortError"))},l.open(c.method,c.url,!0),"include"===c.credentials?l.withCredentials=!0:"omit"===c.credentials&&(l.withCredentials=!1),"responseType"in l&&o&&(l.responseType="blob"),c.headers.forEach((function(e,t){l.setRequestHeader(t,e)})),c.signal&&(c.signal.addEventListener("abort",f),l.onreadystatechange=function(){4===l.readyState&&c.signal.removeEventListener("abort",f)}),l.send(void 0===c._bodyInit?null:c._bodyInit)}))}N.polyfill=!0,e.fetch||(e.fetch=N,e.Headers=y,e.Request=_,e.Response=I),t.Headers=y,t.Request=_,t.Response=I,t.fetch=N,Object.defineProperty(t,"__esModule",{value:!0})}({})}(o),o.fetch.ponyfill=!0,delete o.fetch.polyfill;var c=o;(t=c.fetch).default=c.fetch,t.fetch=c.fetch,t.Headers=c.Headers,t.Request=c.Request,t.Response=c.Response,e.exports=t},878:function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return $}));n(87),n(107),n(43),n(111),n(116),n(58);var r=n(8),o=n(202),c=n(52),l=n(1),f=n(11),d=n(12),h=n(19),v=n(24),m=n(17),y=(n(66),n(48),n(51),n(42),n(46),n(39),n(16),n(114),n(71),n(91),n(77),n(85),n(73),n(117),n(36),n(86),n(37),n(264),n(229)),O=n(79),R=n(194),w=n(5),E=n(83),x=n.n(E),j=n(47),_=n(57);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(m.a)(e);if(t){var o=Object(m.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}function I(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var N="client",b="".concat("wc","@").concat(2,":").concat(N,":"),P=N,T="error",A=(j.THIRTY_DAYS,"Proposal expired"),C=j.SEVEN_DAYS,M={wc_sessionPropose:{req:{ttl:j.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:j.ONE_DAY,prompt:!1,tag:1104},res:{ttl:j.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:j.ONE_DAY,prompt:!1,tag:1106},res:{ttl:j.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:j.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:j.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:j.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:j.ONE_DAY,prompt:!1,tag:1112},res:{ttl:j.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:j.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:j.THIRTY_SECONDS,prompt:!1,tag:1115}}},U={min:j.FIVE_MINUTES,max:j.SEVEN_DAYS},D=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"],L=Object.defineProperty,V=Object.defineProperties,J=Object.getOwnPropertyDescriptors,H=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable,K=function(e,t,n){return t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},W=function(e,t){for(var n in t||(t={}))B.call(t,n)&&K(e,n,t[n]);if(H){var r,o=I(H(t));try{for(o.s();!(r=o.n()).done;){n=r.value;Y.call(t,n)&&K(e,n,t[n])}}catch(e){o.e(e)}finally{o.f()}}return e},G=function(e,t){return V(e,J(t))},F=function(e){Object(h.a)(v,e);var t,n,r,o=S(v);function v(e){var t;return Object(f.a)(this,v),(t=o.call(this,e)).name="engine",t.events=new x.a,t.initialized=!1,t.ignoredPayloadTypes=[w.b],t.init=Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.initialized,e.t0){e.next=8;break}return e.next=4,t.cleanup();case 4:t.registerRelayerEvents(),t.registerExpirerEvents(),t.client.core.pairing.register({methods:Object.keys(M)}),t.initialized=!0;case 8:case"end":return e.stop()}}),e)}))),t.connect=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,i,o,c,a,f,d,h,v,m,O,g,R,E,x,_,S,I,k,N,P;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isInitialized(),s=G(W({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}}),e.next=4,t.isValidConnect(s);case 4:if(r=s.pairingTopic,i=s.requiredNamespaces,o=s.optionalNamespaces,c=s.sessionProperties,a=s.relays,h=!1,(f=r)&&(h=t.client.core.pairing.pairings.get(f).active),f&&h){e.next=13;break}return e.next=9,t.client.core.pairing.create();case 9:v=e.sent,m=v.topic,O=v.uri,f=m,d=O;case 13:return e.next=15,t.client.core.crypto.generateKeyPair();case 15:if(g=e.sent,R=W({requiredNamespaces:i,optionalNamespaces:o,relays:null!=a?a:[{protocol:y.c}],proposer:{publicKey:g,metadata:t.client.metadata}},c&&{sessionProperties:c}),E=Object(w.d)(j.FIVE_MINUTES,A),x=E.reject,_=E.resolve,S=E.done,t.events.once(Object(w.k)("session_connect"),function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var r,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.error,o=n.session,!r){e.next=5;break}x(r),e.next=17;break;case 5:if(!o){e.next=17;break}return o.self.publicKey=g,c=G(W({},o),{requiredNamespaces:o.requiredNamespaces,optionalNamespaces:o.optionalNamespaces}),e.next=10,t.client.session.set(o.topic,c);case 10:return e.next=12,t.setExpiry(o.topic,o.expiry);case 12:if(e.t0=f,!e.t0){e.next=16;break}return e.next=16,t.client.core.pairing.updateMetadata({topic:f,metadata:o.peer.metadata});case 16:_(c);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),f){e.next=24;break}throw I=Object(w.t)("NO_MATCHING_KEY","connect() pairing topic: ".concat(f)),k=I.message,new Error(k);case 24:return e.next=26,t.sendRequest(f,"wc_sessionPropose",R);case 26:return N=e.sent,P=Object(w.c)(j.FIVE_MINUTES),e.next=30,t.setProposal(N,W({id:N,expiry:P},R));case 30:return e.abrupt("return",{uri:d,approval:S});case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.pair=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isInitialized(),e.next=3,t.client.core.pairing.pair(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.approve=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,i,o,c,a,l,f,d,g,h,v,m,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isInitialized(),e.next=3,t.isValidApprove(n);case 3:return s=n.id,r=n.relayProtocol,i=n.namespaces,o=n.sessionProperties,c=t.client.proposal.get(s),a=c.pairingTopic,l=c.proposer,f=c.requiredNamespaces,d=c.optionalNamespaces,a=a||"",Object(w.V)(f)||(f=Object(w.w)(i,"approve()")),e.next=8,t.client.core.crypto.generateKeyPair();case 8:return g=e.sent,h=l.publicKey,e.next=12,t.client.core.crypto.generateSharedKey(g,h);case 12:if(v=e.sent,e.t0=a&&s,!e.t0){e.next=23;break}return e.next=17,t.client.core.pairing.updateMetadata({topic:a,metadata:l.metadata});case 17:return e.next=19,t.sendResult(s,a,{relay:{protocol:null!=r?r:"irn"},responderPublicKey:g});case 19:return e.next=21,t.client.proposal.delete(s,Object(w.x)("USER_DISCONNECTED"));case 21:return e.next=23,t.client.core.pairing.activate({topic:a});case 23:return m=W({relay:{protocol:null!=r?r:"irn"},namespaces:i,requiredNamespaces:f,optionalNamespaces:d,pairingTopic:a,controller:{publicKey:g,metadata:t.client.metadata},expiry:Object(w.c)(C)},o&&{sessionProperties:o}),e.next=26,t.client.core.relayer.subscribe(v);case 26:return e.next=28,t.sendRequest(v,"wc_sessionSettle",m);case 28:return y=G(W({},m),{topic:v,pairingTopic:a,acknowledged:!1,self:m.controller,peer:{publicKey:l.publicKey,metadata:l.metadata},controller:g}),e.next=31,t.client.session.set(v,y);case 31:return e.next=33,t.setExpiry(v,Object(w.c)(C));case 33:return e.abrupt("return",{topic:v,acknowledged:function(){return new Promise((function(e){return setTimeout((function(){return e(t.client.session.get(v))}),500)}))}});case 34:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.reject=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isInitialized(),e.next=3,t.isValidReject(n);case 3:if(s=n.id,r=n.reason,o=t.client.proposal.get(s),i=o.pairingTopic,e.t0=i,!e.t0){e.next=10;break}return e.next=8,t.sendError(s,i,r);case 8:return e.next=10,t.client.proposal.delete(s,Object(w.x)("USER_DISCONNECTED"));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.update=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,i,o,c,l,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isInitialized(),e.next=3,t.isValidUpdate(n);case 3:return s=n.topic,r=n.namespaces,e.next=7,t.sendRequest(s,"wc_sessionUpdate",{namespaces:r});case 7:return i=e.sent,o=Object(w.d)(),c=o.done,l=o.resolve,a=o.reject,t.events.once(Object(w.k)("session_update",i),(function(e){var t=e.error;t?a(t):l()})),e.next=15,t.client.session.update(s,{namespaces:r});case 15:return e.abrupt("return",{acknowledged:c});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.extend=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,o,i,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isInitialized(),e.next=3,t.isValidExtend(n);case 3:return s=n.topic,e.next=6,t.sendRequest(s,"wc_sessionExtend",{});case 6:return r=e.sent,o=Object(w.d)(),i=o.done,c=o.resolve,l=o.reject,t.events.once(Object(w.k)("session_extend",r),(function(e){var a=e.error;a?l(a):c()})),e.next=14,t.setExpiry(s,Object(w.c)(C));case 14:return e.abrupt("return",{acknowledged:i});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.request=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,i,o,c,l,a,f,d,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isInitialized(),e.next=3,t.isValidRequest(n);case 3:return s=n.chainId,r=n.request,i=n.topic,o=n.expiry,e.next=9,t.sendRequest(i,"wc_sessionRequest",{request:r,chainId:s},o);case 9:return c=e.sent,l=Object(w.d)(o),a=l.done,f=l.resolve,d=l.reject,t.events.once(Object(w.k)("session_request",c),(function(e){var g=e.error,t=e.result;g?d(g):f(t)})),t.client.events.emit("session_request_sent",{topic:i,request:r,chainId:s,id:c}),e.next=17,t.client.core.storage.getItem("WALLETCONNECT_DEEPLINK_CHOICE");case 17:return h=e.sent,Object(w.y)({id:c,topic:i,wcDeepLink:h}),e.next=21,a();case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.respond=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isInitialized(),e.next=3,t.isValidRespond(n);case 3:if(s=n.topic,r=n.response,i=r.id,!Object(_.isJsonRpcResult)(r)){e.next=9;break}return e.next=7,t.sendResult(i,s,r.result);case 7:e.next=13;break;case 9:if(e.t0=Object(_.isJsonRpcError)(r),!e.t0){e.next=13;break}return e.next=13,t.sendError(i,s,r.error);case 13:t.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.ping=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,o,i,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isInitialized(),e.next=3,t.isValidPing(n);case 3:if(s=n.topic,!t.client.session.keys.includes(s)){e.next=17;break}return e.next=7,t.sendRequest(s,"wc_sessionPing",{});case 7:return r=e.sent,o=Object(w.d)(),i=o.done,c=o.resolve,l=o.reject,t.events.once(Object(w.k)("session_ping",r),(function(e){var a=e.error;a?l(a):c()})),e.next=15,i();case 15:e.next=21;break;case 17:if(e.t0=t.client.core.pairing.pairings.keys.includes(s),!e.t0){e.next=21;break}return e.next=21,t.client.core.pairing.ping({topic:s});case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.emit=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isInitialized(),e.next=3,t.isValidEmit(n);case 3:return s=n.topic,r=n.event,i=n.chainId,e.next=6,t.sendRequest(s,"wc_sessionEvent",{event:r,chainId:i});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.disconnect=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isInitialized(),e.next=3,t.isValidDisconnect(n);case 3:if(s=n.topic,!t.client.session.keys.includes(s)){e.next=13;break}return r=Object(_.getBigIntRpcId)().toString(),o=function e(n){(null==n?void 0:n.id.toString())===r&&(t.client.core.relayer.events.removeListener(y.d.message_ack,e),i())},e.next=9,Promise.all([new Promise((function(e){i=e,t.client.core.relayer.on(y.d.message_ack,o)})),t.sendRequest(s,"wc_sessionDelete",Object(w.x)("USER_DISCONNECTED"),void 0,r)]);case 9:return e.next=11,t.deleteSession(s);case 11:e.next=15;break;case 13:return e.next=15,t.client.core.pairing.disconnect({topic:s});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.find=function(e){return t.isInitialized(),t.client.session.getAll().filter((function(s){return Object(w.I)(s,e)}))},t.getPendingSessionRequests=function(){return t.isInitialized(),t.client.pendingRequest.getAll()},t.cleanupDuplicatePairings=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=t.client.core.pairing.pairings.get(n.pairingTopic),0!==(r=t.client.core.pairing.pairings.getAll().filter((function(i){var e,t;return(null==(e=i.peerMetadata)?void 0:e.url)&&(null==(t=i.peerMetadata)?void 0:t.url)===n.peer.metadata.url&&i.topic&&i.topic!==s.topic}))).length){e.next=4;break}return e.abrupt("return");case 4:return t.client.logger.info("Cleaning up ".concat(r.length," duplicate pairing(s)")),e.next=7,Promise.all(r.map((function(i){return t.client.core.pairing.disconnect({topic:i.topic})})));case 7:t.client.logger.info("Duplicate pairings clean up finished"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),t.client.logger.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),t.deleteSession=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.client.session.get(n),o=r.self,e.next=3,t.client.core.relayer.unsubscribe(n);case 3:if(t.client.session.delete(n,Object(w.x)("USER_DISCONNECTED")),e.t0=t.client.core.crypto.keychain.has(o.publicKey),!e.t0){e.next=8;break}return e.next=8,t.client.core.crypto.deleteKeyPair(o.publicKey);case 8:if(e.t1=t.client.core.crypto.keychain.has(n),!e.t1){e.next=12;break}return e.next=12,t.client.core.crypto.deleteSymKey(n);case 12:s||t.client.core.expirer.del(n);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.deleteProposal=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.client.proposal.delete(n,Object(w.x)("USER_DISCONNECTED")),s?Promise.resolve():t.client.core.expirer.del(n)]);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.deletePendingSessionRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]&&o[2],e.next=3,Promise.all([t.client.pendingRequest.delete(n,s),r?Promise.resolve():t.client.core.expirer.del(n)]);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.setExpiry=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.client.session.keys.includes(n),!e.t0){e.next=4;break}return e.next=4,t.client.session.update(n,{expiry:s});case 4:t.client.core.expirer.set(n,s);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.setProposal=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.client.proposal.set(n,s);case 2:t.client.core.expirer.set(n,s.expiry);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.setPendingSessionRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=M.wc_sessionRequest.req.ttl,r=n.id,i=n.topic,o=n.params,e.next=3,t.client.pendingRequest.set(r,{id:r,topic:i,params:o});case 3:s&&t.client.core.expirer.set(r,Object(w.c)(s));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s,r,i,o){var c,l,a,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Object(_.formatJsonRpcRequest)(s,r),!Object(w.B)()||!D.includes(s)){e.next=5;break}return l=Object(w.A)(JSON.stringify(c)),e.next=5,t.client.core.verify.register({attestationId:l});case 5:return e.next=7,t.client.core.crypto.encode(n,c);case 7:return a=e.sent,f=M[s].req,e.abrupt("return",(i&&(f.ttl=i),o&&(f.id=o),t.client.core.history.set(n,c),t.client.core.relayer.publish(n,a,f),c.id));case 10:case"end":return e.stop()}}),e)})));return function(t,n,r,o,c){return e.apply(this,arguments)}}(),t.sendResult=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s,r){var i,o,c,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(_.formatJsonRpcResult)(n,r),e.next=3,t.client.core.crypto.encode(s,i);case 3:return o=e.sent,e.next=6,t.client.core.history.get(s,n);case 6:return c=e.sent,a=M[c.request.method].res,t.client.core.relayer.publish(s,o,a),e.next=11,t.client.core.history.resolve(i);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.sendError=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s,r){var i,o,c,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(_.formatJsonRpcError)(n,r),e.next=3,t.client.core.crypto.encode(s,i);case 3:return o=e.sent,e.next=6,t.client.core.history.get(s,n);case 6:return c=e.sent,a=M[c.request.method].res,t.client.core.relayer.publish(s,o,a),e.next=11,t.client.core.history.resolve(i);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.cleanup=Object(l.a)(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],s=[],t.client.session.getAll().forEach((function(e){Object(w.E)(e.expiry)&&n.push(e.topic)})),t.client.proposal.getAll().forEach((function(e){Object(w.E)(e.expiry)&&s.push(e.id)})),e.next=5,Promise.all([].concat(Object(c.a)(n.map((function(e){return t.deleteSession(e)}))),Object(c.a)(s.map((function(e){return t.deleteProposal(e)})))));case 5:case"end":return e.stop()}}),e)}))),t.onRelayEventRequest=function(e){var s=e.topic,n=e.payload,i=n.method;switch(i){case"wc_sessionPropose":return t.onSessionProposeRequest(s,n);case"wc_sessionSettle":return t.onSessionSettleRequest(s,n);case"wc_sessionUpdate":return t.onSessionUpdateRequest(s,n);case"wc_sessionExtend":return t.onSessionExtendRequest(s,n);case"wc_sessionPing":return t.onSessionPingRequest(s,n);case"wc_sessionDelete":return t.onSessionDeleteRequest(s,n);case"wc_sessionRequest":return t.onSessionRequest(s,n);case"wc_sessionEvent":return t.onSessionEventRequest(s,n);default:return t.client.logger.info("Unsupported request method ".concat(i))}},t.onRelayEventResponse=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.topic,r=n.payload,e.next=4,t.client.core.history.get(s,r.id);case 4:i=e.sent.request.method,e.t0=i,e.next="wc_sessionPropose"===e.t0?8:"wc_sessionSettle"===e.t0?9:"wc_sessionUpdate"===e.t0?10:"wc_sessionExtend"===e.t0?11:"wc_sessionPing"===e.t0?12:"wc_sessionRequest"===e.t0?13:14;break;case 8:return e.abrupt("return",t.onSessionProposeResponse(s,r));case 9:return e.abrupt("return",t.onSessionSettleResponse(s,r));case 10:return e.abrupt("return",t.onSessionUpdateResponse(s,r));case 11:return e.abrupt("return",t.onSessionExtendResponse(s,r));case 12:return e.abrupt("return",t.onSessionPingResponse(s,r));case 13:return e.abrupt("return",t.onSessionRequestResponse(s,r));case 14:return e.abrupt("return",t.client.logger.info("Unsupported response method ".concat(i)));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.onRelayEventUnknownPayload=function(e){var s=e.topic,t=Object(w.t)("MISSING_OR_INVALID","Decoded payload on topic ".concat(s," is not identifiable as a JSON-RPC request or a response.")).message;throw new Error(t)},t.onSessionProposeRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r,i,o,c,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.params,i=s.id,e.prev=1,t.isValidConnect(W({},s.params)),o=Object(w.c)(j.FIVE_MINUTES),c=W({id:i,pairingTopic:n,expiry:o},r),e.next=6,t.setProposal(i,c);case 6:return a=Object(w.A)(JSON.stringify(s)),e.next=9,t.getVerifyContext(a,c.proposer.metadata);case 9:l=e.sent,t.client.events.emit("session_proposal",{id:i,params:c,verifyContext:l}),e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(1),e.next=17,t.sendError(i,n,e.t0);case 17:t.client.logger.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n){return e.apply(this,arguments)}}(),t.onSessionProposeResponse=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r,o,c,l,a,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.id,!Object(_.isJsonRpcResult)(s)){e.next=22;break}return o=s.result,t.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o}),c=t.client.proposal.get(r),t.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:c}),l=c.proposer.publicKey,t.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:l}),a=o.responderPublicKey,t.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:a}),e.next=12,t.client.core.crypto.generateSharedKey(l,a);case 12:return f=e.sent,t.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:f}),e.next=16,t.client.core.relayer.subscribe(f);case 16:return d=e.sent,t.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),e.next=20,t.client.core.pairing.activate({topic:n});case 20:e.next=27;break;case 22:if(e.t0=Object(_.isJsonRpcError)(s),!e.t0){e.next=27;break}return e.next=26,t.client.proposal.delete(r,Object(w.x)("USER_DISCONNECTED"));case 26:t.events.emit(Object(w.k)("session_connect"),{error:s.error});case 27:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.onSessionSettleRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r,i,o,c,l,a,f,d,h,g,v,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.id,i=s.params,e.prev=1,t.isValidSessionSettleRequest(i),o=s.params,c=o.relay,l=o.controller,a=o.expiry,f=o.namespaces,d=o.requiredNamespaces,h=o.optionalNamespaces,g=o.sessionProperties,v=o.pairingTopic,m=W({topic:n,relay:c,expiry:a,namespaces:f,acknowledged:!0,pairingTopic:v,requiredNamespaces:d,optionalNamespaces:h,controller:l.publicKey,self:{publicKey:"",metadata:t.client.metadata},peer:{publicKey:l.publicKey,metadata:l.metadata}},g&&{sessionProperties:g}),e.next=6,t.sendResult(s.id,n,!0);case 6:t.events.emit(Object(w.k)("session_connect"),{session:m}),t.cleanupDuplicatePairings(m),e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,t.sendError(r,n,e.t0);case 14:t.client.logger.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}(),t.onSessionSettleResponse=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.id,!Object(_.isJsonRpcResult)(s)){e.next=7;break}return e.next=4,t.client.session.update(n,{acknowledged:!0});case 4:t.events.emit(Object(w.k)("session_approve",r),{}),e.next=12;break;case 7:if(e.t0=Object(_.isJsonRpcError)(s),!e.t0){e.next=12;break}return e.next=11,t.client.session.delete(n,Object(w.x)("USER_DISCONNECTED"));case 11:t.events.emit(Object(w.k)("session_approve",r),{error:s.error});case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.onSessionUpdateRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.params,i=s.id,e.prev=1,t.isValidUpdate(W({topic:n},r)),e.next=5,t.client.session.update(n,{namespaces:r.namespaces});case 5:return e.next=7,t.sendResult(i,n,!0);case 7:t.client.events.emit("session_update",{id:i,topic:n,params:r}),e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,t.sendError(i,n,e.t0);case 14:t.client.logger.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}(),t.onSessionUpdateResponse=function(e,s){var n=s.id;Object(_.isJsonRpcResult)(s)?t.events.emit(Object(w.k)("session_update",n),{}):Object(_.isJsonRpcError)(s)&&t.events.emit(Object(w.k)("session_update",n),{error:s.error})},t.onSessionExtendRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.id,e.prev=1,t.isValidExtend({topic:n}),e.next=5,t.setExpiry(n,Object(w.c)(C));case 5:return e.next=7,t.sendResult(r,n,!0);case 7:t.client.events.emit("session_extend",{id:r,topic:n}),e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,t.sendError(r,n,e.t0);case 14:t.client.logger.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}(),t.onSessionExtendResponse=function(e,s){var n=s.id;Object(_.isJsonRpcResult)(s)?t.events.emit(Object(w.k)("session_extend",n),{}):Object(_.isJsonRpcError)(s)&&t.events.emit(Object(w.k)("session_extend",n),{error:s.error})},t.onSessionPingRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.id,e.prev=1,t.isValidPing({topic:n}),e.next=5,t.sendResult(r,n,!0);case 5:t.client.events.emit("session_ping",{id:r,topic:n}),e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(1),e.next=12,t.sendError(r,n,e.t0);case 12:t.client.logger.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),t.onSessionPingResponse=function(e,s){var n=s.id;setTimeout((function(){Object(_.isJsonRpcResult)(s)?t.events.emit(Object(w.k)("session_ping",n),{}):Object(_.isJsonRpcError)(s)&&t.events.emit(Object(w.k)("session_ping",n),{error:s.error})}),500)},t.onSessionDeleteRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.id,e.prev=1,t.isValidDisconnect({topic:n,reason:s.params}),e.next=5,Promise.all([new Promise((function(i){t.client.core.relayer.once(y.d.publish,Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=i,e.next=3,t.deleteSession(n);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)}))))})),t.sendResult(r,n,!0)]);case 5:t.client.events.emit("session_delete",{id:r,topic:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t.client.logger.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),t.onSessionRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r,i,o,c,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.id,i=s.params,e.prev=1,t.isValidRequest(W({topic:n},i)),e.next=5,t.setPendingSessionRequest({id:r,topic:n,params:i});case 5:return o=Object(w.A)(JSON.stringify(s)),c=t.client.session.get(n),e.next=9,t.getVerifyContext(o,c.peer.metadata);case 9:a=e.sent,t.client.events.emit("session_request",{id:r,topic:n,params:i,verifyContext:a}),e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(1),e.next=17,t.sendError(r,n,e.t0);case 17:t.client.logger.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n){return e.apply(this,arguments)}}(),t.onSessionRequestResponse=function(e,s){var n=s.id;Object(_.isJsonRpcResult)(s)?t.events.emit(Object(w.k)("session_request",n),{result:s.result}):Object(_.isJsonRpcError)(s)&&t.events.emit(Object(w.k)("session_request",n),{error:s.error})},t.onSessionEventRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=s.id,i=s.params,e.prev=1,t.isValidEmit(W({topic:n},i)),t.client.events.emit("session_event",{id:r,topic:n,params:i}),e.next=10;break;case 5:return e.prev=5,e.t0=e.catch(1),e.next=9,t.sendError(r,n,e.t0);case 9:t.client.logger.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,5]])})));return function(t,n){return e.apply(this,arguments)}}(),t.isValidConnect=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var r,a,s,o,i,c,l,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.W)(n)){e.next=3;break}throw r=Object(w.t)("MISSING_OR_INVALID","connect() params: ".concat(JSON.stringify(n))),a=r.message,new Error(a);case 3:if(s=n.pairingTopic,o=n.requiredNamespaces,i=n.optionalNamespaces,c=n.sessionProperties,l=n.relays,e.t0=Object(w.L)(s),e.t0){e.next=8;break}return e.next=8,t.isValidPairingTopic(s);case 8:if(Object(w.Y)(l,!0)){e.next=11;break}throw f=Object(w.t)("MISSING_OR_INVALID","connect() relays: ".concat(l)),d=f.message,new Error(d);case 11:!Object(w.L)(o)&&0!==Object(w.V)(o)&&t.validateNamespaces(o,"requiredNamespaces"),!Object(w.L)(i)&&0!==Object(w.V)(i)&&t.validateNamespaces(i,"optionalNamespaces"),Object(w.L)(c)||t.validateSessionProps(c,"sessionProperties");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.validateNamespaces=function(e,s){var t=Object(w.bb)(e,"connect()",s);if(t)throw new Error(t.message)},t.isValidApprove=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var s,r,i,o,c,a,l,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.W)(n)){e.next=2;break}throw new Error(Object(w.t)("MISSING_OR_INVALID","approve() params: ".concat(n)).message);case 2:return s=n.id,r=n.namespaces,i=n.relayProtocol,o=n.sessionProperties,e.next=5,t.isValidProposalId(s);case 5:if(c=t.client.proposal.get(s),!(a=Object(w.R)(r,"approve()"))){e.next=8;break}throw new Error(a.message);case 8:if(!(l=Object(w.D)(c.requiredNamespaces,r,"approve()"))){e.next=11;break}throw new Error(l.message);case 11:if(Object(w.db)(i,!0)){e.next=14;break}throw f=Object(w.t)("MISSING_OR_INVALID","approve() relayProtocol: ".concat(i)),d=f.message,new Error(d);case 14:Object(w.L)(o)||t.validateSessionProps(o,"sessionProperties");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.isValidReject=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var r,o,s,c,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.W)(n)){e.next=3;break}throw r=Object(w.t)("MISSING_OR_INVALID","reject() params: ".concat(n)),o=r.message,new Error(o);case 3:return s=n.id,c=n.reason,e.next=6,t.isValidProposalId(s);case 6:if(Object(w.O)(c)){e.next=9;break}throw l=Object(w.t)("MISSING_OR_INVALID","reject() reason: ".concat(JSON.stringify(c))),f=l.message,new Error(f);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.isValidSessionSettleRequest=function(e){if(!Object(w.W)(e)){var t=Object(w.t)("MISSING_OR_INVALID","onSessionSettleRequest() params: ".concat(e)).message;throw new Error(t)}var s=e.relay,n=e.controller,i=e.namespaces,r=e.expiry;if(!Object(w.X)(s)){var o=Object(w.t)("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string").message;throw new Error(o)}var c=Object(w.N)(n,"onSessionSettleRequest()");if(c)throw new Error(c.message);var a=Object(w.R)(i,"onSessionSettleRequest()");if(a)throw new Error(a.message);if(Object(w.E)(r)){var l=Object(w.t)("EXPIRED","onSessionSettleRequest()").message;throw new Error(l)}},t.isValidUpdate=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var r,a,s,o,i,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.W)(n)){e.next=3;break}throw r=Object(w.t)("MISSING_OR_INVALID","update() params: ".concat(n)),a=r.message,new Error(a);case 3:return s=n.topic,o=n.namespaces,e.next=6,t.isValidSessionTopic(s);case 6:if(i=t.client.session.get(s),!(c=Object(w.R)(o,"update()"))){e.next=9;break}throw new Error(c.message);case 9:if(!(l=Object(w.D)(i.requiredNamespaces,o,"update()"))){e.next=12;break}throw new Error(l.message);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.isValidExtend=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var r,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.W)(n)){e.next=3;break}throw r=Object(w.t)("MISSING_OR_INVALID","extend() params: ".concat(n)),o=r.message,new Error(o);case 3:return s=n.topic,e.next=6,t.isValidSessionTopic(s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.isValidRequest=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var r,a,s,o,i,c,l,f,d,h,v,m,y,O,R,E;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.W)(n)){e.next=3;break}throw r=Object(w.t)("MISSING_OR_INVALID","request() params: ".concat(n)),a=r.message,new Error(a);case 3:return s=n.topic,o=n.request,i=n.chainId,c=n.expiry,e.next=6,t.isValidSessionTopic(s);case 6:if(l=t.client.session.get(s),f=l.namespaces,Object(w.S)(f,i)){e.next=10;break}throw d=Object(w.t)("MISSING_OR_INVALID","request() chainId: ".concat(i)),h=d.message,new Error(h);case 10:if(Object(w.Z)(o)){e.next=13;break}throw v=Object(w.t)("MISSING_OR_INVALID","request() ".concat(JSON.stringify(o))),m=v.message,new Error(m);case 13:if(Object(w.U)(f,i,o.method)){e.next=16;break}throw y=Object(w.t)("MISSING_OR_INVALID","request() method: ".concat(o.method)),O=y.message,new Error(O);case 16:if(!c||Object(w.ab)(c,U)){e.next=19;break}throw R=Object(w.t)("MISSING_OR_INVALID","request() expiry: ".concat(c,". Expiry must be a number (in seconds) between ").concat(U.min," and ").concat(U.max)),E=R.message,new Error(E);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.isValidRespond=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var r,o,s,c,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.W)(n)){e.next=3;break}throw r=Object(w.t)("MISSING_OR_INVALID","respond() params: ".concat(n)),o=r.message,new Error(o);case 3:return s=n.topic,c=n.response,e.next=6,t.isValidSessionTopic(s);case 6:if(Object(w.cb)(c)){e.next=9;break}throw l=Object(w.t)("MISSING_OR_INVALID","respond() response: ".concat(JSON.stringify(c))),f=l.message,new Error(f);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.isValidPing=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var r,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.W)(n)){e.next=3;break}throw r=Object(w.t)("MISSING_OR_INVALID","ping() params: ".concat(n)),o=r.message,new Error(o);case 3:return s=n.topic,e.next=6,t.isValidSessionOrPairingTopic(s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.isValidEmit=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var r,o,s,c,i,l,f,d,h,v,m,y,O;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.W)(n)){e.next=3;break}throw r=Object(w.t)("MISSING_OR_INVALID","emit() params: ".concat(n)),o=r.message,new Error(o);case 3:return s=n.topic,c=n.event,i=n.chainId,e.next=6,t.isValidSessionTopic(s);case 6:if(l=t.client.session.get(s),f=l.namespaces,Object(w.S)(f,i)){e.next=10;break}throw d=Object(w.t)("MISSING_OR_INVALID","emit() chainId: ".concat(i)),h=d.message,new Error(h);case 10:if(Object(w.P)(c)){e.next=13;break}throw v=Object(w.t)("MISSING_OR_INVALID","emit() event: ".concat(JSON.stringify(c))),m=v.message,new Error(m);case 13:if(Object(w.T)(f,i,c.name)){e.next=16;break}throw y=Object(w.t)("MISSING_OR_INVALID","emit() event: ".concat(JSON.stringify(c))),O=y.message,new Error(O);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.isValidDisconnect=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n){var r,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.W)(n)){e.next=3;break}throw r=Object(w.t)("MISSING_OR_INVALID","disconnect() params: ".concat(n)),o=r.message,new Error(o);case 3:return s=n.topic,e.next=6,t.isValidSessionOrPairingTopic(s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.getVerifyContext=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,s){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}},e.prev=1,e.next=4,t.client.core.verify.resolve({attestationId:n,verifyUrl:s.verifyUrl});case 4:(o=e.sent)&&(r.verified.origin=o,r.verified.validation=o===s.url?"VALID":"INVALID"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t.client.logger.error(e.t0);case 11:return e.abrupt("return",(t.client.logger.info("Verify context: ".concat(JSON.stringify(r))),r));case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),t.validateSessionProps=function(e,s){Object.values(e).forEach((function(e){if(!Object(w.db)(e,!1)){var t=Object(w.t)("MISSING_OR_INVALID","".concat(s," must be in Record<string, string> format. Received: ").concat(JSON.stringify(e))).message;throw new Error(t)}}))},t}return Object(d.a)(v,[{key:"isInitialized",value:function(){if(!this.initialized){var e=Object(w.t)("NOT_INITIALIZED",this.name).message;throw new Error(e)}}},{key:"registerRelayerEvents",value:function(){var e=this;this.client.core.relayer.on(y.d.message,function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(n){var r,s,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.topic,s=n.message,!e.ignoredPayloadTypes.includes(e.client.core.crypto.getPayloadType(s))){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.client.core.crypto.decode(r,s);case 5:if(o=t.sent,!Object(_.isJsonRpcRequest)(o)){t.next=10;break}e.client.core.history.set(r,o),e.onRelayEventRequest({topic:r,payload:o}),t.next=17;break;case 10:if(!Object(_.isJsonRpcResponse)(o)){t.next=16;break}return t.next=13,e.client.core.history.resolve(o);case 13:e.onRelayEventResponse({topic:r,payload:o}),t.next=17;break;case 16:e.onRelayEventUnknownPayload({topic:r,payload:o});case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"registerExpirerEvents",value:function(){var e=this;this.client.core.expirer.on(y.b.expired,function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(n){var r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Object(w.ib)(n.target),o=r.topic,!(s=r.id)||!e.client.pendingRequest.keys.includes(s)){t.next=5;break}return t.next=4,e.deletePendingSessionRequest(s,Object(w.t)("EXPIRED"),!0);case 4:return t.abrupt("return",t.sent);case 5:if(!o){t.next=13;break}if(t.t0=e.client.session.keys.includes(o),!t.t0){t.next=11;break}return t.next=10,e.deleteSession(o,!0);case 10:e.client.events.emit("session_expire",{topic:o});case 11:t.next=18;break;case 13:if(t.t1=s,!t.t1){t.next=18;break}return t.next=17,e.deleteProposal(s,!0);case 17:e.client.events.emit("proposal_expire",{id:s});case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"isValidPairingTopic",value:function(e){if(!Object(w.db)(e,!1)){var t=Object(w.t)("MISSING_OR_INVALID","pairing topic should be a string: ".concat(e)).message;throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){var n=Object(w.t)("NO_MATCHING_KEY","pairing topic doesn't exist: ".concat(e)).message;throw new Error(n)}if(Object(w.E)(this.client.core.pairing.pairings.get(e).expiry)){var r=Object(w.t)("EXPIRED","pairing topic: ".concat(e)).message;throw new Error(r)}}},{key:"isValidSessionTopic",value:(r=Object(l.a)(regeneratorRuntime.mark((function e(t){var n,r,o,c,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.db)(t,!1)){e.next=3;break}throw n=Object(w.t)("MISSING_OR_INVALID","session topic should be a string: ".concat(t)),r=n.message,new Error(r);case 3:if(this.client.session.keys.includes(t)){e.next=6;break}throw o=Object(w.t)("NO_MATCHING_KEY","session topic doesn't exist: ".concat(t)),c=o.message,new Error(c);case 6:if(!Object(w.E)(this.client.session.get(t).expiry)){e.next=11;break}return e.next=9,this.deleteSession(t);case 9:throw l=Object(w.t)("EXPIRED","session topic: ".concat(t)),f=l.message,new Error(f);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"isValidSessionOrPairingTopic",value:(n=Object(l.a)(regeneratorRuntime.mark((function e(t){var n,r,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.client.session.keys.includes(t)){e.next=5;break}return e.next=3,this.isValidSessionTopic(t);case 3:e.next=16;break;case 5:if(!this.client.core.pairing.pairings.keys.includes(t)){e.next=9;break}this.isValidPairingTopic(t),e.next=16;break;case 9:if(!Object(w.db)(t,!1)){e.next=14;break}throw n=Object(w.t)("NO_MATCHING_KEY","session or pairing topic doesn't exist: ".concat(t)),r=n.message,new Error(r);case 14:throw o=Object(w.t)("MISSING_OR_INVALID","session or pairing topic should be a string: ".concat(t)),c=o.message,new Error(c);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"isValidProposalId",value:(t=Object(l.a)(regeneratorRuntime.mark((function e(t){var n,r,o,c,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.Q)(t)){e.next=3;break}throw n=Object(w.t)("MISSING_OR_INVALID","proposal id should be a number: ".concat(t)),r=n.message,new Error(r);case 3:if(this.client.proposal.keys.includes(t)){e.next=6;break}throw o=Object(w.t)("NO_MATCHING_KEY","proposal id doesn't exist: ".concat(t)),c=o.message,new Error(c);case 6:if(!Object(w.E)(this.client.proposal.get(t).expiry)){e.next=11;break}return e.next=9,this.deleteProposal(t);case 9:throw l=Object(w.t)("EXPIRED","proposal id: ".concat(t)),f=l.message,new Error(f);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),v}(R.b),z=function(e){Object(h.a)(n,e);var t=S(n);function n(e,r){var o;return Object(f.a)(this,n),(o=t.call(this,e,r,"proposal",b)).core=e,o.logger=r,o}return Object(d.a)(n)}(y.e),X=function(e){Object(h.a)(n,e);var t=S(n);function n(e,r){var o;return Object(f.a)(this,n),(o=t.call(this,e,r,"session",b)).core=e,o.logger=r,o}return Object(d.a)(n)}(y.e),Q=function(e){Object(h.a)(n,e);var t=S(n);function n(e,r){var o;return Object(f.a)(this,n),(o=t.call(this,e,r,"request",b,(function(s){return s.id}))).core=e,o.logger=r,o}return Object(d.a)(n)}(y.e),$=function(e){Object(h.a)(v,e);var t,n,c=S(v);function v(e){var t;Object(f.a)(this,v),(t=c.call(this,e)).protocol="wc",t.version=2,t.name=P,t.events=new E.EventEmitter,t.on=function(s,e){return t.events.on(s,e)},t.once=function(s,e){return t.events.once(s,e)},t.off=function(s,e){return t.events.off(s,e)},t.removeListener=function(s,e){return t.events.removeListener(s,e)},t.removeAllListeners=function(s){return t.events.removeAllListeners(s)},t.connect=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.engine.connect(s);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),t.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),t.pair=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.engine.pair(s);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),t.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),t.approve=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.engine.approve(s);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),t.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),t.reject=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.engine.reject(s);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),t.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),t.update=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.engine.update(s);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),t.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),t.extend=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.engine.extend(s);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),t.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),t.request=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.engine.request(s);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),t.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),t.respond=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.engine.respond(s);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),t.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),t.ping=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.engine.ping(s);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),t.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),t.emit=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.engine.emit(s);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),t.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),t.disconnect=function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.engine.disconnect(s);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),t.logger.error(e.t0.message),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),t.find=function(s){try{return t.engine.find(s)}catch(e){throw t.logger.error(e.message),e}},t.getPendingSessionRequests=function(){try{return t.engine.getPendingSessionRequests()}catch(e){throw t.logger.error(e.message),e}},t.name=(null==e?void 0:e.name)||P,t.metadata=(null==e?void 0:e.metadata)||Object(w.s)();var n=Object(r.a)(null==e?void 0:e.logger)<"u"&&"string"!=typeof(null==e?void 0:e.logger)?e.logger:Object(O.pino)(Object(O.getDefaultLoggerOptions)({level:(null==e?void 0:e.logger)||T}));return t.core=(null==e?void 0:e.core)||new y.a(e),t.logger=Object(O.generateChildLogger)(n,t.name),t.session=new X(t.core,t.logger),t.proposal=new z(t.core,t.logger),t.pendingRequest=new Q(t.core,t.logger),t.engine=new F(Object(o.a)(t)),t}return Object(d.a)(v,[{key:"context",get:function(){return Object(O.getLoggerContext)(this.logger)}},{key:"pairing",get:function(){return this.core.pairing.pairings}},{key:"initialize",value:(n=Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.trace("Initialized"),e.prev=1,e.next=4,this.core.start();case 4:return e.next=6,this.session.init();case 6:return e.next=8,this.proposal.init();case 8:return e.next=10,this.pendingRequest.init();case 10:return e.next=12,this.engine.init();case 12:this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success"),e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(1),this.logger.info("SignClient Initialization Failure"),this.logger.error(e.t0.message),e.t0;case 19:case"end":return e.stop()}}),e,this,[[1,16]])}))),function(){return n.apply(this,arguments)})}],[{key:"init",value:(t=Object(l.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new v(t),e.next=3,n.initialize();case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),v}(R.h)}}]);